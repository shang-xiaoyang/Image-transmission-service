"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}Object.defineProperty(exports,"__esModule",{value:!0});var e,a=t(require("axios")),n=t(require("lodash/get")),o=t(require("lodash/set")),i=t(require("qs")),c=t(require("debug")),s=t(require("crypto-js/hmac-sha256")),r=t(require("crypto-js/sha256")),u=t(require("crypto-js/md5")),p=t(require("crypto-js/enc-base64")),l=t(require("crypto-js/enc-hex")),d=t(require("crypto-js/enc-utf8")),h=t(require("lodash/cloneDeep")),m=t(require("axios/lib/utils")),f=t(require("axios/lib/core/settle")),y=t(require("axios/lib/helpers/buildURL")),g=t(require("axios/lib/core/buildFullPath")),x=t(require("axios/lib/core/createError")),k=t(require("axios-adapter-uniapp"));class b extends Error{constructor(t){const{data:e}=t;super(e.Message),this.code=void 0,this.data=void 0,this.statusCode=void 0,this.headers=void 0,this.requestId=void 0,this.id2=void 0,this.ec=void 0,Object.setPrototypeOf(this,b.prototype),this.data=e,this.code=e.Code,this.statusCode=t.status,this.headers=t.headers,this.requestId=t.headers["x-tos-request-id"]||t.data.RequestId,this.id2=t.headers["x-tos-id-2"],this.ec=t.headers["x-tos-ec"]||t.data.EC}}(e=exports.TosServerCode||(exports.TosServerCode={})).NoSuchBucket="NoSuchBucket",e.NoSuchKey="NoSuchKey",e.AccessDenied="AccessDenied",e.MalformedAcl="MalformedAclError",e.UnexpectedContent="UnexpectedContent",e.InvalidRequest="InvalidRequest",e.MissingSecurityHeader="MissingSecurityHeader",e.InvalidArgument="InvalidArgument",e.EntityTooSmall="EntityTooSmall",e.InvalidBucketName="InvalidBucketName",e.BucketNotEmpty="BucketNotEmpty",e.TooManyBuckets="TooManyBuckets",e.BucketAlreadyExists="BucketAlreadyExists",e.MalformedBody="MalformedBody",e.NoSuchLifecycleConfiguration="NoSuchLifecycleConfiguration",e.ReplicationConfigurationNotFound="ReplicationConfigurationNotFoundError",e.InvalidLocationConstraint="InvalidLocationConstraint",e.AuthorizationQueryParametersError="AuthorizationQueryParametersError",e.RequestTimeTooSkewed="RequestTimeTooSkewed",e.SignatureDoesNotMatch="SignatureDoesNotMatch",e.RequestedRangeNotSatisfiable="Requested Range Not Satisfiable",e.PreconditionFailed="PreconditionFailed",e.BadDigest="BadDigest",e.InvalidDigest="InvalidDigest",e.EntityTooLarge="EntityTooLarge",e.UnImplemented="UnImplemented",e.MethodNotAllowed="MethodNotAllowed",e.InvalidAccessKeyId="InvalidAccessKeyId",e.InvalidSecurityToken="InvalidSecurityToken",e.ContentSHA256Mismatch="ContentSHA256Mismatch",e.ExceedQPSLimit="ExceedQPSLimit",e.ExceedRateLimit="ExceedRateLimit",e.NoSuchCORSConfiguration="NoSuchCORSConfiguration",e.NoSuchMirrorConfiguration="NoSuchMirrorConfiguration",e.NoSuchWebsiteConfiguration="NoSuchWebsiteConfiguration",e.MissingRequestBody="MissingRequestBodyError",e.BucketAlreadyOwnedByYou="BucketAlreadyOwnedByYou",e.NoSuchBucketPolicy="NoSuchBucketPolicy",e.PolicyTooLarge="PolicyTooLarge",e.MalformedPolicy="MalformedPolicy",e.InvalidKey="InvalidKey",e.MirrorFailed="MirrorFailed",e.Timeout="Timeout",e.OffsetNotMatched="OffsetNotMatched",e.NotAppendable="NotAppendable",e.ContextCanceled="ContextCanceled",e.InternalError="InternalError",e.TooManyRequests="TooManyRequests",e.TimeOut="TimeOut",e.ConcurrencyUpdateObjectLimit="ConcurrencyUpdateObjectLimit",e.DuplicateUpload="DuplicateUpload",e.DuplicateObject="DuplicateObject",e.InvalidVersionId="InvalidVersionId",e.StorageClassNotMatch="StorageClassNotMatch",e.UploadStatusNotUploading="UploadStatusNotUploading",e.PartSizeNotMatch="PartSizeNotMatch",e.NoUploadPart="NoUploadPart",e.PartsLenInvalid="PartsLenInvalid",e.PartsIdxSmall="PartsIdxSmall",e.PartSizeSmall="PartSizeSmall",e.PrefixNotNextKeyPrefix="PrefixNotNextKeyPrefix",e.InvalidPart="InvalidPart",e.InvalidPartOffset="InvalidPartOffset",e.MismatchObject="MismatchObject",e.UploadStatusMismatch="UploadStatusMismatch",e.CompletingStatusNoExpiration="CompletingStatusNoExpiration",e.Found="Found",e.InvalidRedirectLocation="InvalidRedirectLocation";class T extends Error{constructor(t){super(t),Object.setPrototypeOf(this,T.prototype)}}class v extends Error{constructor(t){super(t),Object.setPrototypeOf(this,v.prototype)}}const w=c("TOS"),S=t=>e=>{if(null==t||"object"!=typeof t)return;const a=n(t,e);Array.isArray(a)||o(t,e,null==a?[]:[a])},E=t=>{const e=a=>Array.isArray(a)?a.map(t=>e(t)):"string"==typeof a?t(a):"object"==typeof a&&null!=a?Object.keys(a).reduce((t,n)=>(t[e(n)]=a[n],t),{}):a;return e},C=E(t=>t.replace(/[A-Z]/g,"-$&").toLowerCase()),B=E(t=>t[0].toUpperCase()+t.slice(1)),I=t=>{const e=[];return Object.keys(t).sort().forEach(a=>{e.push(`${encodeURIComponent(a)}=${encodeURIComponent(t[a])}`)}),e.join("&")},R=t=>{const e=t||{},a={};Object.keys(e).forEach(t=>{null!=e[t]&&(a[t]=e[t])});const n={};return Object.keys(a).forEach(t=>{const e=t.toLowerCase();n[e]=a[t]}),n},P=t=>{var e;return"string"==typeof t&&(t={url:t}),t&&null==(null==(e=t)?void 0:e.needProxyParams)&&(t.needProxyParams=!0),t};async function A(t){try{return[null,await t]}catch(t){return[t,null]}}function O(t){return"undefined"!=typeof Blob&&t instanceof Blob}function D(t){return"undefined"!=typeof Buffer&&t instanceof Buffer}function M(t){return t?Object.keys(t).map(e=>{const a=""+t[e];return`${encodeURIComponent(e)}=${encodeURIComponent(a)}`}).join("&"):""}function j(t){return t instanceof v}const N=t=>"string"==typeof t?t:t.toUTCString(),_={projectName:"x-tos-project-name",encodingType:"encoding-type",cacheControl:"cache-control",contentDisposition:"content-disposition",contentLength:"content-length",contentMD5:"content-md5",contentSHA256:"x-tos-content-sha256",contentEncoding:"content-encoding",contentLanguage:"content-language",contentType:"content-type",expires:["expires",t=>t.toUTCString()],range:"range",ifMatch:"if-match",ifModifiedSince:["if-modified-since",N],ifNoneMatch:"if-none-match",ifUnmodifiedSince:["if-unmodified-since",N],acl:"x-tos-acl",grantFullControl:"x-tos-grant-full-control",grantRead:"x-tos-grant-read",grantReadAcp:"x-tos-grant-read-acp",grantWrite:"x-tos-grant-write",grantWriteAcp:"x-tos-grant-write-acp",serverSideEncryption:"x-tos-server-side-encryption",serverSideDataEncryption:"x-tos-server-side-data-encryption",ssecAlgorithm:"x-tos-server-side-encryption-customer-algorithm",ssecKey:"x-tos-server-side-encryption-customer-key",ssecKeyMD5:"x-tos-server-side-encryption-customer-key-md5",copySourceRange:"x-tos-copy-source-range",copySourceIfMatch:"x-tos-copy-source-if-match",copySourceIfModifiedSince:["x-tos-copy-source-if-modified-since",N],copySourceIfNoneMatch:"x-tos-copy-source-if-none-match",copySourceIfUnmodifiedSince:"x-tos-copy-source-if-unmodified-since",copySourceSSECAlgorithm:"x-tos-copy-source-server-side-encryption-customer-algorithm",copySourceSSECKey:"x-tos-copy-source-server-side-encryption-customer-key",copySourceSSECKeyMD5:"x-tos-copy-source-server-side-encryption-customer-key-MD5",metadataDirective:"x-tos-metadata-directive",meta:t=>Object.keys(t).reduce((e,a)=>(e["x-tos-meta-"+a]=""+t[a],e),{}),websiteRedirectLocation:"x-tos-website-redirect-location",storageClass:"x-tos-storage-class",azRedundancy:"x-tos-az-redundancy",trafficLimit:"x-tos-traffic-limit",callback:"x-tos-callback",callbackVar:"x-tos-callback-var",allowSameActionOverlap:["x-tos-allow-same-action-overlap",t=>String(t)],symLinkTargetKey:"x-tos-symlink-target",symLinkTargetBucket:"x-tos-symlink-bucket",forbidOverwrite:"x-tos-forbid-overwrite",bucketType:"x-tos-bucket-type",recursiveMkdir:"x-tos-recursive-mkdir",tagging:"x-tos-tagging"},U={versionId:"versionId",process:"x-tos-process",saveBucket:"x-tos-save-bucket",saveObject:"x-tos-save-object",responseCacheControl:"response-cache-control",responseContentDisposition:"response-content-disposition",responseContentEncoding:"response-content-encoding",responseContentLanguage:"response-content-language",responseContentType:"response-content-type",responseExpires:["response-expires",t=>t.toUTCString()]};function L(t,e){if(!e.length)return;const a=t.headers||{};function n(t,e){null==a[t]&&(a[t]=e)}t.headers=a,e.forEach(e=>{const a=_[e];if(!a)throw new T(`\`${e}\` isn't in keys of \`requestHeadersMap\``);const o=t[e];if(null==o)return;if("string"==typeof a)return n(a,""+o);if(Array.isArray(a))return n(a[0],a[1](o));const i=a(o);Object.entries(i).forEach(([t,e])=>{n(t,e)})})}const z=t=>i.stringify(t);function F(t,e){return{data:t,statusCode:e.statusCode,headers:e.headers,requestId:e.requestId,id2:e.id2}}function G(t,e){const a=e["x-tos-hash-crc64ecma"];if(null==a)return void console.warn("No x-tos-hash-crc64ecma in response's headers, please see https://www.volcengine.com/docs/6349/127737 to add `x-tos-hash-crc64ecma` to Expose-Headers field.");const n="string"==typeof t?t:t.getCrc64();if(n!==a)throw new T(`validate file crc64 failed. Expect crc64 ${a}, actual crc64 ${n}. Please try again.`)}var q;!function(t){t.LastModified="last-modified",t.ContentLength="content-length",t.AcceptEncoding="accept-encoding",t.ContentEncoding="content-encoding",t.ContentMD5="content-md5",t.TosRawContentLength="x-tos-raw-content-length",t.TosTrailer="x-tos-trailer",t.TosHashCrc64ecma="x-tos-hash-crc64ecma",t.TosContentSha256="x-tos-content-sha256",t.TosDecodedContentLength="x-tos-decoded-content-length",t.TosEc="x-tos-ec",t.TosRequestId="x-tos-request-id"}(q||(q={}));const K=t=>{let e=Promise.resolve();return async()=>(e=e.then(()=>t()),e)},V=(t,e)=>{if(!e&&t){if(t.length<3||t.length>63)throw new T("invalid bucket name, the length must be [3, 63]");if(!/^([a-z]|-|\d)+$/.test(t))throw new T("invalid bucket name, the character set is illegal");if(/^-/.test(t)||/-$/.test(t))throw new T("invalid bucket name, the bucket name can be neither starting with '-' nor ending with '-'")}};async function $(t){t=this.normalizeObjectInput(t);const e=R(t.headers);return t.headers=e,L(t,["encodingType","cacheControl","contentDisposition","contentEncoding","contentLanguage","contentType","expires","acl","grantFullControl","grantRead","grantReadAcp","grantWriteAcp","ssecAlgorithm","ssecKey","ssecKeyMD5","serverSideEncryption","serverSideDataEncryption","meta","websiteRedirectLocation","storageClass","forbidOverwrite"]),this.setObjectContentTypeHeader(t,e),this._fetchObject(t,"POST",{uploads:""},e,"")}const H=(t,e,a=!1)=>{let n=e;e<5242880&&(n=5242880,a&&console.warn(`partSize has been set to ${n}, because the partSize you provided is less than the minimal size of multipart`));const o=Math.ceil(t/1e4);return e<o&&(n=o,a&&console.warn(`partSize has been set to ${n}, because the partSize you provided causes the number of part excesses 10,000`)),n};async function W(t){const{uploadId:e,...a}=t,n=await this._fetchObject(t,"GET",{uploadId:e,...C(a)},{});return S(n.data)("Parts"),n}const J={"3gp":"video/3gpp","7z":"application/x-7z-compressed",abw:"application/x-abiword",ai:"application/postscript",aif:"audio/x-aiff",aifc:"audio/x-aiff",aiff:"audio/x-aiff",alc:"chemical/x-alchemy",amr:"audio/amr",anx:"application/annodex",apk:"application/vnd.android.package-archive",appcache:"text/cache-manifest",art:"image/x-jg",asc:"text/plain",asf:"video/x-ms-asf",aso:"chemical/x-ncbi-asn1-binary",asx:"video/x-ms-asf",atom:"application/atom+xml",atomcat:"application/atomcat+xml",atomsrv:"application/atomserv+xml",au:"audio/basic",avi:"video/x-msvideo",awb:"audio/amr-wb",axa:"audio/annodex",axv:"video/annodex",b:"chemical/x-molconn-Z",bak:"application/x-trash",bat:"application/x-msdos-program",bcpio:"application/x-bcpio",bib:"text/x-bibtex",bin:"application/octet-stream",bmp:"image/x-ms-bmp",boo:"text/x-boo",book:"application/x-maker",brf:"text/plain",bsd:"chemical/x-crossfire",c:"text/x-csrc","c++":"text/x-c++src",c3d:"chemical/x-chem3d",cab:"application/x-cab",cac:"chemical/x-cache",cache:"chemical/x-cache",cap:"application/vnd.tcpdump.pcap",cascii:"chemical/x-cactvs-binary",cat:"application/vnd.ms-pki.seccat",cbin:"chemical/x-cactvs-binary",cbr:"application/x-cbr",cbz:"application/x-cbz",cc:"text/x-c++src",cda:"application/x-cdf",cdf:"application/x-cdf",cdr:"image/x-coreldraw",cdt:"image/x-coreldrawtemplate",cdx:"chemical/x-cdx",cdy:"application/vnd.cinderella",cef:"chemical/x-cxf",cer:"chemical/x-cerius",chm:"chemical/x-chemdraw",chrt:"application/x-kchart",cif:"chemical/x-cif",class:"application/java-vm",cls:"text/x-tex",cmdf:"chemical/x-cmdf",cml:"chemical/x-cml",cod:"application/vnd.rim.cod",com:"application/x-msdos-program",cpa:"chemical/x-compass",cpio:"application/x-cpio",cpp:"text/x-c++src",cpt:"application/mac-compactpro",cr2:"image/x-canon-cr2",crl:"application/x-pkcs7-crl",crt:"application/x-x509-ca-cert",crw:"image/x-canon-crw",csd:"audio/csound",csf:"chemical/x-cache-csf",csh:"application/x-csh",csm:"chemical/x-csml",csml:"chemical/x-csml",css:"text/css",csv:"text/csv",ctab:"chemical/x-cactvs-binary",ctx:"chemical/x-ctx",cu:"application/cu-seeme",cub:"chemical/x-gaussian-cube",cxf:"chemical/x-cxf",cxx:"text/x-c++src",d:"text/x-dsrc",davmount:"application/davmount+xml",dcm:"application/dicom",dcr:"application/x-director",ddeb:"application/vnd.debian.binary-package",dif:"video/dv",diff:"text/x-diff",dir:"application/x-director",djv:"image/vnd.djvu",djvu:"image/vnd.djvu",dl:"video/dl",dll:"application/x-msdos-program",dmg:"application/x-apple-diskimage",dms:"application/x-dms",doc:"application/msword",docm:"application/vnd.ms-word.document.macroEnabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroEnabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",dv:"video/dv",dvi:"application/x-dvi",dx:"chemical/x-jcamp-dx",dxr:"application/x-director",emb:"chemical/x-embl-dl-nucleotide",embl:"chemical/x-embl-dl-nucleotide",eml:"message/rfc822",eot:"application/vnd.ms-fontobject",eps:"application/postscript",eps2:"application/postscript",eps3:"application/postscript",epsf:"application/postscript",epsi:"application/postscript",erf:"image/x-epson-erf",es:"application/ecmascript",etx:"text/x-setext",exe:"application/x-msdos-program",ez:"application/andrew-inset",fb:"application/x-maker",fbdoc:"application/x-maker",fch:"chemical/x-gaussian-checkpoint",fchk:"chemical/x-gaussian-checkpoint",fig:"application/x-xfig",flac:"audio/flac",fli:"video/fli",flv:"video/x-flv",fm:"application/x-maker",frame:"application/x-maker",frm:"application/x-maker",gal:"chemical/x-gaussian-log",gam:"chemical/x-gamess-input",gamin:"chemical/x-gamess-input",gan:"application/x-ganttproject",gau:"chemical/x-gaussian-input",gcd:"text/x-pcs-gcd",gcf:"application/x-graphing-calculator",gcg:"chemical/x-gcg8-sequence",gen:"chemical/x-genbank",gf:"application/x-tex-gf",gif:"image/gif",gjc:"chemical/x-gaussian-input",gjf:"chemical/x-gaussian-input",gl:"video/gl",gnumeric:"application/x-gnumeric",gpt:"chemical/x-mopac-graph",gsf:"application/x-font",gsm:"audio/x-gsm",gtar:"application/x-gtar",gz:"application/gzip",h:"text/x-chdr","h++":"text/x-c++hdr",hdf:"application/x-hdf",hh:"text/x-c++hdr",hin:"chemical/x-hin",hpp:"text/x-c++hdr",hqx:"application/mac-binhex40",hs:"text/x-haskell",hta:"application/hta",htc:"text/x-component",htm:"text/html",html:"text/html",hwp:"application/x-hwp",hxx:"text/x-c++hdr",ica:"application/x-ica",ice:"x-conference/x-cooltalk",ico:"image/vnd.microsoft.icon",ics:"text/calendar",icz:"text/calendar",ief:"image/ief",iges:"model/iges",igs:"model/iges",iii:"application/x-iphone",info:"application/x-info",inp:"chemical/x-gamess-input",ins:"application/x-internet-signup",iso:"application/x-iso9660-image",isp:"application/x-internet-signup",ist:"chemical/x-isostar",istr:"chemical/x-isostar",jad:"text/vnd.sun.j2me.app-descriptor",jam:"application/x-jam",jar:"application/java-archive",java:"text/x-java",jdx:"chemical/x-jcamp-dx",jmz:"application/x-jmol",jng:"image/x-jng",jnlp:"application/x-java-jnlp-file",jp2:"image/jp2",jpe:"image/jpeg",jpeg:"image/jpeg",jpf:"image/jpx",jpg:"image/jpeg",jpg2:"image/jp2",jpm:"image/jpm",jpx:"image/jpx",js:"application/javascript",json:"application/json",kar:"audio/midi",key:"application/pgp-keys",kil:"application/x-killustrator",kin:"chemical/x-kinemage",kml:"application/vnd.google-earth.kml+xml",kmz:"application/vnd.google-earth.kmz",kpr:"application/x-kpresenter",kpt:"application/x-kpresenter",ksp:"application/x-kspread",kwd:"application/x-kword",kwt:"application/x-kword",latex:"application/x-latex",lha:"application/x-lha",lhs:"text/x-literate-haskell",lin:"application/bbolin",lsf:"video/x-la-asf",lsx:"video/x-la-asf",ltx:"text/x-tex",ly:"text/x-lilypond",lyx:"application/x-lyx",lzh:"application/x-lzh",lzx:"application/x-lzx",m3g:"application/m3g",m3u:"audio/x-mpegurl",m3u8:"application/x-mpegURL",m4a:"audio/mpeg",maker:"application/x-maker",man:"application/x-troff-man",mbox:"application/mbox",mcif:"chemical/x-mmcif",mcm:"chemical/x-macmolecule",mdb:"application/msaccess",me:"application/x-troff-me",mesh:"model/mesh",mid:"audio/midi",midi:"audio/midi",mif:"application/x-mif",mkv:"video/x-matroska",mm:"application/x-freemind",mmd:"chemical/x-macromodel-input",mmf:"application/vnd.smaf",mml:"text/mathml",mmod:"chemical/x-macromodel-input",mng:"video/x-mng",moc:"text/x-moc",mol:"chemical/x-mdl-molfile",mol2:"chemical/x-mol2",moo:"chemical/x-mopac-out",mop:"chemical/x-mopac-input",mopcrt:"chemical/x-mopac-input",mov:"video/quicktime",movie:"video/x-sgi-movie",mp2:"audio/mpeg",mp3:"audio/mpeg",mp4:"video/mp4",mpc:"chemical/x-mopac-input",mpe:"video/mpeg",mpeg:"video/mpeg",mpega:"audio/mpeg",mpg:"video/mpeg",mpga:"audio/mpeg",mph:"application/x-comsol",mpv:"video/x-matroska",ms:"application/x-troff-ms",msh:"model/mesh",msi:"application/x-msi",mvb:"chemical/x-mopac-vib",mxf:"application/mxf",mxu:"video/vnd.mpegurl",nb:"application/mathematica",nbp:"application/mathematica",nc:"application/x-netcdf",nef:"image/x-nikon-nef",nwc:"application/x-nwc",o:"application/x-object",oda:"application/oda",odb:"application/vnd.oasis.opendocument.database",odc:"application/vnd.oasis.opendocument.chart",odf:"application/vnd.oasis.opendocument.formula",odg:"application/vnd.oasis.opendocument.graphics",odi:"application/vnd.oasis.opendocument.image",odm:"application/vnd.oasis.opendocument.text-master",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",oga:"audio/ogg",ogg:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",old:"application/x-trash",one:"application/onenote",onepkg:"application/onenote",onetmp:"application/onenote",onetoc2:"application/onenote",opf:"application/oebps-package+xml",opus:"audio/ogg",orc:"audio/csound",orf:"image/x-olympus-orf",otf:"application/font-sfnt",otg:"application/vnd.oasis.opendocument.graphics-template",oth:"application/vnd.oasis.opendocument.text-web",otp:"application/vnd.oasis.opendocument.presentation-template",ots:"application/vnd.oasis.opendocument.spreadsheet-template",ott:"application/vnd.oasis.opendocument.text-template",oza:"application/x-oz-application",p:"text/x-pascal",p7r:"application/x-pkcs7-certreqresp",pac:"application/x-ns-proxy-autoconfig",pas:"text/x-pascal",pat:"image/x-coreldrawpattern",patch:"text/x-diff",pbm:"image/x-portable-bitmap",pcap:"application/vnd.tcpdump.pcap",pcf:"application/x-font-pcf","pcf.Z":"application/x-font-pcf",pcx:"image/pcx",pdb:"chemical/x-pdb",pdf:"application/pdf",pfa:"application/x-font",pfb:"application/x-font",pfr:"application/font-tdpfr",pgm:"image/x-portable-graymap",pgn:"application/x-chess-pgn",pgp:"application/pgp-encrypted",php:"#application/x-httpd-php",php3:"#application/x-httpd-php3",php3p:"#application/x-httpd-php3-preprocessed",php4:"#application/x-httpd-php4",php5:"#application/x-httpd-php5",phps:"#application/x-httpd-php-source",pht:"#application/x-httpd-php",phtml:"#application/x-httpd-php",pk:"application/x-tex-pk",pl:"text/x-perl",pls:"audio/x-scpls",pm:"text/x-perl",png:"image/png",pnm:"image/x-portable-anymap",pot:"text/plain",potm:"application/vnd.ms-powerpoint.template.macroEnabled.12",potx:"application/vnd.openxmlformats-officedocument.presentationml.template",ppam:"application/vnd.ms-powerpoint.addin.macroEnabled.12",ppm:"image/x-portable-pixmap",pps:"application/vnd.ms-powerpoint",ppsm:"application/vnd.ms-powerpoint.slideshow.macroEnabled.12",ppsx:"application/vnd.openxmlformats-officedocument.presentationml.slideshow",ppt:"application/vnd.ms-powerpoint",pptm:"application/vnd.ms-powerpoint.presentation.macroEnabled.12",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",prf:"application/pics-rules",prt:"chemical/x-ncbi-asn1-ascii",ps:"application/postscript",psd:"image/x-photoshop",py:"text/x-python",pyc:"application/x-python-code",pyo:"application/x-python-code",qgs:"application/x-qgis",qt:"video/quicktime",qtl:"application/x-quicktimeplayer",ra:"audio/x-pn-realaudio",ram:"audio/x-pn-realaudio",rar:"application/rar",ras:"image/x-cmu-raster",rb:"application/x-ruby",rd:"chemical/x-mdl-rdfile",rdf:"application/rdf+xml",rdp:"application/x-rdp",rgb:"image/x-rgb",rhtml:"#application/x-httpd-eruby",rm:"audio/x-pn-realaudio",roff:"application/x-troff",ros:"chemical/x-rosdal",rpm:"application/x-redhat-package-manager",rss:"application/x-rss+xml",rtf:"application/rtf",rtx:"text/richtext",rxn:"chemical/x-mdl-rxnfile",scala:"text/x-scala",sce:"application/x-scilab",sci:"application/x-scilab",sco:"audio/csound",scr:"application/x-silverlight",sct:"text/scriptlet",sd:"chemical/x-mdl-sdfile",sd2:"audio/x-sd2",sda:"application/vnd.stardivision.draw",sdc:"application/vnd.stardivision.calc",sdd:"application/vnd.stardivision.impress",sds:"application/vnd.stardivision.chart",sdw:"application/vnd.stardivision.writer",ser:"application/java-serialized-object",sfd:"application/vnd.font-fontforge-sfd",sfv:"text/x-sfv",sgf:"application/x-go-sgf",sgl:"application/vnd.stardivision.writer-global",sh:"application/x-sh",shar:"application/x-shar",shp:"application/x-qgis",shtml:"text/html",shx:"application/x-qgis",sid:"audio/prs.sid",sig:"application/pgp-signature",sik:"application/x-trash",silo:"model/mesh",sis:"application/vnd.symbian.install",sisx:"x-epoc/x-sisx-app",sit:"application/x-stuffit",sitx:"application/x-stuffit",skd:"application/x-koan",skm:"application/x-koan",skp:"application/x-koan",skt:"application/x-koan",sldm:"application/vnd.ms-powerpoint.slide.macroEnabled.12",sldx:"application/vnd.openxmlformats-officedocument.presentationml.slide",smi:"application/smil+xml",smil:"application/smil+xml",snd:"audio/basic",spc:"chemical/x-galactic-spc",spl:"application/x-futuresplash",spx:"audio/ogg",sql:"application/x-sql",src:"application/x-wais-source",srt:"text/plain",stc:"application/vnd.sun.xml.calc.template",std:"application/vnd.sun.xml.draw.template",sti:"application/vnd.sun.xml.impress.template",stw:"application/vnd.sun.xml.writer.template",sty:"text/x-tex",sv4cpio:"application/x-sv4cpio",sv4crc:"application/x-sv4crc",svg:"image/svg+xml",svgz:"image/svg+xml",sw:"chemical/x-swissprot",swf:"application/x-shockwave-flash",swfl:"application/x-shockwave-flash",sxc:"application/vnd.sun.xml.calc",sxd:"application/vnd.sun.xml.draw",sxg:"application/vnd.sun.xml.writer.global",sxi:"application/vnd.sun.xml.impress",sxm:"application/vnd.sun.xml.math",sxw:"application/vnd.sun.xml.writer",t:"application/x-troff",tar:"application/x-tar",taz:"application/x-gtar-compressed",tcl:"application/x-tcl",tex:"text/x-tex",texi:"application/x-texinfo",texinfo:"application/x-texinfo",text:"text/plain",tgf:"chemical/x-mdl-tgf",tgz:"application/x-gtar-compressed",thmx:"application/vnd.ms-officetheme",tif:"image/tiff",tiff:"image/tiff",tk:"text/x-tcl",tm:"text/texmacs",torrent:"application/x-bittorrent",tr:"application/x-troff",ts:"video/MP2T",tsp:"application/dsptype",tsv:"text/tab-separated-values",ttf:"application/font-sfnt",ttl:"text/turtle",txt:"text/plain",uls:"text/iuls",ustar:"application/x-ustar",val:"chemical/x-ncbi-asn1-binary",vcard:"text/vcard",vcd:"application/x-cdlink",vcf:"text/vcard",vcs:"text/x-vcalendar",vmd:"chemical/x-vmd",vms:"chemical/x-vamas-iso14976",vrm:"x-world/x-vrml",vrml:"model/vrml",vsd:"application/vnd.visio",vss:"application/vnd.visio",vst:"application/vnd.visio",vsw:"application/vnd.visio",wad:"application/x-doom",wasm:"application/wasm",wav:"audio/wav",wax:"audio/x-ms-wax",wbmp:"image/vnd.wap.wbmp",wbxml:"application/vnd.wap.wbxml",webm:"video/webm",wk:"application/x-123",wm:"video/x-ms-wm",wma:"audio/x-ms-wma",wmd:"application/x-ms-wmd",wml:"text/vnd.wap.wml",wmlc:"application/vnd.wap.wmlc",wmls:"text/vnd.wap.wmlscript",wmlsc:"application/vnd.wap.wmlscriptc",wmv:"video/x-ms-wmv",wmx:"video/x-ms-wmx",wmz:"application/x-ms-wmz",woff:"application/font-woff",wp5:"application/vnd.wordperfect5.1",wpd:"application/vnd.wordperfect",wrl:"model/vrml",wsc:"text/scriptlet",wvx:"video/x-ms-wvx",wz:"application/x-wingz",x3d:"model/x3d+xml",x3db:"model/x3d+binary",x3dv:"model/x3d+vrml",xbm:"image/x-xbitmap",xcf:"application/x-xcf",xcos:"application/x-scilab-xcos",xht:"application/xhtml+xml",xhtml:"application/xhtml+xml",xlam:"application/vnd.ms-excel.addin.macroEnabled.12",xlb:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.12",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroEnabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xml:"application/xml",xpi:"application/x-xpinstall",xpm:"image/x-xpixmap",xsd:"application/xml",xsl:"application/xslt+xml",xslt:"application/xslt+xml",xspf:"application/xspf+xml",xtel:"chemical/x-xtel",xul:"application/vnd.mozilla.xul+xml",xwd:"image/x-xwindowdump",xyz:"chemical/x-xyz",xz:"application/x-xz",zip:"application/zip",webp:"image/webp"};let Q=null;Q={__proto__:null,CRC:class{reset(){}async updateBlob(){throw new T("Not implemented.(CRC may cause browser lag.)")}update(t){throw new T("Not implemented.(CRC may cause browser lag.)")}}};const{combineCrc64:X}=Q;let Y=null;Y={__proto__:null,createDefaultRateLimiter:function(t,e){throw Error("no implemention in browser environment")},createRateLimiterStream:function(t){throw Error("no implemention in browser environment")}};const{createDefaultRateLimiter:Z}=Y;var tt;function et(t){if(("string"==typeof t?t:t.key).length<1)throw new T("invalid object name, the length must be greater than 1")}function at(t,e){if(D(t))return t.length;if(O(t))return t.size;if(e&&e["content-length"]){const t=+e["content-length"];if(t>=0)return t}return null}async function nt(t){const e=function({body:t}){return{body:t,makeRetryStream:void 0}}(t);return async function({body:t,beforeRetry:e,makeRetryStream:a}){return{body:t,beforeRetry:e,makeRetryStream:a}}(t={...t,...e})}function ot(t,e){return`/${t}/${encodeURIComponent(e)}`}!function(t){t.HeaderRestore="x-tos-restore",t.HeaderRestoreExpiryDays="x-tos-restore-expiry-days",t.HeaderRestoreRequestDate="x-tos-restore-request-date",t.HeaderRestoreTier="x-tos-restore-tier",t.HeaderProjectName="x-tos-project-name",t.HeaderReplicationStatus="x-tos-replication-status"}(tt||(tt={}));const it=t=>{if(!t)return;const e=null==t?void 0:t[tt.HeaderRestore];if(e){var a,n,o;const c=null!=(a=null==(n=(null!=e?e:"").split('",')[1])||null==n.split||null==(o=n.split("="))?void 0:o[1])?a:"",s='ongoing-request="true"'===(null==e?void 0:e.trim()),r={RestoreStatus:{OngoingRequest:s,ExpiryDate:c}};var i;return s&&(r.RestoreParam={ExpiryDays:t[tt.HeaderRestoreExpiryDays]?Number(t[tt.HeaderRestoreExpiryDays]):0,RequestDate:null!=(i=t[tt.HeaderRestoreRequestDate])?i:"",Tier:t[tt.HeaderRestoreTier]}),r}};var ct;(ct=exports.DataTransferType||(exports.DataTransferType={}))[ct.Started=1]="Started",ct[ct.Rw=2]="Rw",ct[ct.Succeed=3]="Succeed",ct[ct.Failed=4]="Failed";const st=["content-length","user-agent","host"];function rt(t){switch(t){case"utf-8":return d;case"base64":return p;case"hex":return l;default:throw new T("The coding is not supported")}}function ut(t,e){return e?t.toString(rt(e)):t}const pt=function(t,e){if(D(t))throw new T("not support buffer in browser environment");return ut(u(t),e)};let lt=null;lt={__proto__:null,hmacSha256:function(t,e,a){return ut(s(e,t),a)},hashSha256:function(t,e){return ut(r(t),e)},hashMd5:pt,parse:function(t,e){return rt(e).parse(t)},stringify:function(t,e){return rt(e).stringify(t)}};const{hmacSha256:dt,hashSha256:ht,hashMd5:mt,parse:ft,stringify:yt}=lt;async function gt(t){const{uploadId:e,partNumber:a,body:n,enableContentMD5:o=!1}=t,i=R(t.headers);t.headers=i,L(t,["trafficLimit","ssecAlgorithm","ssecKey","ssecKeyMD5"]);const c=at(n);c&&null==i["content-length"]&&(i["content-length"]=c.toFixed(0)),o&&null==i["content-md5"]&&console.warn("current not support enableMD5Checksum");const s=at(t.body,i),r=null!=s;r||!t.dataTransferStatusChange&&!t.progress||console.warn("Don't get totalSize of uploadPart's body, the `dataTransferStatusChange` callback will not trigger. You can use `uploadPartFromFile` instead");let u=0;const{dataTransferStatusChange:p,progress:l}=t,d=(t,e=0)=>{if(!r||e<0)return;if(!p&&!l)return;u+=e,null==p||p({type:t,rwOnceBytes:e,consumedBytes:u,totalBytes:s});const a=0===s?t===exports.DataTransferType.Succeed?1:0:u/s;1===a?t===exports.DataTransferType.Succeed&&(null==l||l(a)):null==l||l(a)},h=await nt({body:t.body,dataTransferCallback:t=>d(exports.DataTransferType.Rw,t),beforeRetry:t.beforeRetry,makeRetryStream:t.makeRetryStream,enableCRC:this.opts.enableCRC,rateLimiter:t.rateLimiter});d(exports.DataTransferType.Started);const[m,f]=await A((async()=>{const n=await this._fetchObject(t,"PUT",{partNumber:a,uploadId:e},i,h.body,{handleResponse:t=>({partNumber:a,ETag:t.headers.etag,serverSideEncryption:t.headers["x-tos-server-side-encryption"],serverSideDataEncryption:t.headers["x-tos-server-side-data-encryption"],serverSideEncryptionKeyId:t.headers["x-tos-server-side-encryption-kms-key-id"],ssecAlgorithm:t.headers["x-tos-server-side-encryption-customer-algorithm"],ssecKeyMD5:t.headers["x-tos-server-side-encryption-customer-key-MD5"],hashCrc64ecma:t.headers["x-tos-hash-crc64ecma"]}),axiosOpts:{__retryConfig__:{beforeRetry:()=>{u=0,null==h.beforeRetry||h.beforeRetry()},makeRetryStream:h.makeRetryStream},onUploadProgress:t=>{d(exports.DataTransferType.Rw,t.loaded-u)}}});return this.opts.enableCRC&&h.crc&&G(h.crc,n.headers),n})());if(f&&!f.data.ETag)throw new T("No ETag in uploadPart's response headers, please see https://www.volcengine.com/docs/6349/127737 to fix CORS problem");if(m||!f)throw d(exports.DataTransferType.Failed),m;return d(exports.DataTransferType.Succeed),f}async function xt(t){return gt.call(this,t)}async function kt(t){throw new T("uploadPartFromFile doesn't support in browser environment")}async function bt(t){var e;t.headers=null!=(e=t.headers)?e:{},L(t,["callback","callbackVar","forbidOverwrite"]);const a=e=>{const a=e.headers,n={VersionID:a["x-tos-version-id"],ETag:a.etag,Bucket:t.bucket||this.opts.bucket||"",Location:a.location,HashCrc64ecma:a["x-tos-hash-crc64ecma"],Key:t.key,...e.data};return t.callback&&(n.CallbackResult=""+JSON.stringify(e.data)),n};if(t.completeAll){var n;if((null==(n=t.parts)?void 0:n.length)>0)throw new T("Should not specify both 'completeAll' and 'parts' params.");return this._fetchObject(t,"POST",{uploadId:t.uploadId},{...t.headers,"x-tos-complete-all":"yes"},void 0,{handleResponse:a})}return this._fetchObject(t,"POST",{uploadId:t.uploadId},{...t.headers},{Parts:t.parts.map(t=>({ETag:t.eTag,PartNumber:t.partNumber}))},{handleResponse:a})}var Tt;(Tt=exports.UploadEventType||(exports.UploadEventType={}))[Tt.CreateMultipartUploadSucceed=1]="CreateMultipartUploadSucceed",Tt[Tt.CreateMultipartUploadFailed=2]="CreateMultipartUploadFailed",Tt[Tt.UploadPartSucceed=3]="UploadPartSucceed",Tt[Tt.UploadPartFailed=4]="UploadPartFailed",Tt[Tt.UploadPartAborted=5]="UploadPartAborted",Tt[Tt.CompleteMultipartUploadSucceed=6]="CompleteMultipartUploadSucceed",Tt[Tt.CompleteMultipartUploadFailed=7]="CompleteMultipartUploadFailed";const vt=[403,404,405];async function wt(t){var e,a,n;const{cancelToken:o,enableContentMD5:i=!1}=t,c=R(t.headers);t.headers=c,L(t,["encodingType","cacheControl","contentDisposition","contentEncoding","contentLanguage","contentType","expires","acl","grantFullControl","grantRead","grantReadAcp","grantWriteAcp","ssecAlgorithm","ssecKey","ssecKeyMD5","serverSideEncryption","serverSideDataEncryption","meta","websiteRedirectLocation","storageClass"]);const s=()=>o&&!!o.reason,r=await(async()=>null)(),u=await(async()=>{const{file:e}=t;if(r)return r.size;if(D(e))return e.length;if(O(e))return e.size;throw new T("`file` must be string, Buffer, File or Blob")})(),p=await(async()=>"object"==typeof t.checkpoint?{record:t.checkpoint}:{})();await(async()=>{var t;if(r&&null!=(t=p.record)&&t.file_info){var e;const{last_modified:t,file_size:a}=null==(e=p.record)?void 0:e.file_info;r.mtimeMs===t&&r.size===a||(console.warn(`The file has been modified since ${new Date(t)}, so the checkpoint file is invalid, and specified file will be uploaded again.`),delete p.record)}})();const l=H(u,t.partSize||(null==(e=p.record)?void 0:e.part_size)||20971520,!0);p.record&&p.record.part_size!==l&&(console.warn("The partSize param does not equal the partSize in checkpoint file, so the checkpoint file is invalid, and specified file will be uploaded again."),delete p.record);let d=t.bucket||this.opts.bucket||"";const h=t.key;let m="",f=[];const y=function(t,e){const a=[];for(let n=0;;++n){const o=n*e,i=Math.min(e,t-o);if(a.push({offset:o,partSize:i,partNumber:n+1}),(n+1)*e>=t)break}return a}(u,l),g=((null==(a=p.record)?void 0:a.parts_info)||[]).filter(t=>t.is_completed).reduce((t,e)=>t+e.part_size,0);let x=g;const k=(null==(n=p.record)?void 0:n.parts_info)||[],S=new Map;k.forEach(t=>S.set(t.part_number,t));const E=()=>{const t={bucket:d,key:h,part_size:l,upload_id:m,parts_info:k};return r&&(t.file_info={last_modified:r.mtimeMs,file_size:r.size}),t},C=e=>{if(!t.uploadEventChange)return;const a={bucket:d,uploadId:m,key:h,...e};p.filePath&&(a.checkpointFile=p.filePath),t.uploadEventChange(a)};let B;!function(t){t[t.start=1]="start",t[t.uploadPartSucceed=2]="uploadPartSucceed",t[t.completeMultipartUploadSucceed=3]="completeMultipartUploadSucceed"}(B||(B={}));const I=e=>{t.progress&&(x===u&&e===B.uploadPartSucceed||t.progress(e===B.start&&0===u?0:u?x/u:1,E()))};let P=g;const{dataTransferStatusChange:M}=t,j=(t,e=0)=>{M&&(P+=e,null==M||M({type:t,rwOnceBytes:e,consumedBytes:P,totalBytes:u}))},N=K(async()=>{}),_=async(t,e)=>{let a=S.get(t.partNumber);a||(a={part_number:t.partNumber,offset:t.offset,part_size:t.partSize,is_completed:!1,etag:"",hash_crc64ecma:""},k.push(a),S.set(a.part_number,a)),e.err||(a.is_completed=!0,a.etag=e.res.ETag,a.hash_crc64ecma=e.res.hashCrc64ecma),await N();const n={partNumber:a.part_number,partSize:a.part_size,offset:a.offset};if(e.err){const t=e.err;let a=exports.UploadEventType.UploadPartFailed;return t instanceof b&&vt.includes(t.statusCode)&&(a=exports.UploadEventType.UploadPartAborted),void C({type:a,err:t,uploadPartInfo:n})}n.etag=e.res.ETag,x+=n.partSize,C({type:exports.UploadEventType.UploadPartSucceed,uploadPartInfo:n}),I(B.uploadPartSucceed)};if(p.record){d=p.record.bucket,m=p.record.upload_id;const t=new Set((p.record.parts_info||[]).filter(t=>t.is_completed).map(t=>t.part_number));f=y.filter(e=>!t.has(e.partNumber))}else{try{const{data:e}=await $.call(this,t);if(s())throw new v("cancel uploadFile");var U;d=e.Bucket,m=e.UploadId,p.filePathIsPlaceholder&&(p.filePath=null==(U=p.filePath)?void 0:U.replace("@@checkpoint-file-placeholder@@",function(t,e){return`${e}.${mt(`${t}.${e}`,"hex")}.upload`.replace(/[\\/]/g,"")}(d,h))),C({type:exports.UploadEventType.CreateMultipartUploadSucceed})}catch(t){const e=t;throw C({type:exports.UploadEventType.CreateMultipartUploadFailed,err:e}),e}f=y}I(B.start),j(exports.DataTransferType.Started);const[z,F]=await A((async()=>{let e=null,a=0;if(await Promise.all(Array.from({length:t.taskNum||1}).map(async()=>{let n=void 0,o=0,r=null,u=null;try{for(;;){var p;const u=a++;if(u>=f.length)return;function l(t,e){const{offset:a,partSize:o}=e,i=a+o;if(n)return n.make();if(O(t))return t.slice(a,i);if(D(t))return t.slice(a,i);throw new T("`file` must be string, Buffer, File or Blob")}r=f[u],n=void 0;const{data:y}=await gt.call(this,{bucket:d,key:h,uploadId:m,body:l(t.file,r),enableContentMD5:i,makeRetryStream:null==(p=n)?void 0:p.make,beforeRetry:()=>{P-=o,o=0},partNumber:r.partNumber,headers:{"content-length":""+r.partSize,"x-tos-server-side-encryption-customer-algorithm":c["x-tos-server-side-encryption-customer-algorithm"],"x-tos-server-side-encryption-customer-key":c["x-tos-server-side-encryption-customer-key"],"x-tos-server-side-encryption-customer-key-md5":c["x-tos-server-side-encryption-customer-key-md5"]},dataTransferStatusChange(t){t.type===exports.DataTransferType.Rw&&(s()||e||(o+=t.rwOnceBytes,j(t.type,t.rwOnceBytes)))},trafficLimit:t.trafficLimit,rateLimiter:t.rateLimiter});if(s())throw new v("cancel uploadFile");if(e)throw new v("cancel uploadFile by internal error(`firstErr`)");await _(r,{res:y})}}catch(t){u=t,e||(e=u)}try{var y;u?r&&await _(r,{err:u}):(((t,e)=>{t&&"destroy"in t&&"function"==typeof t.destroy&&"destroyed"in t&&!t.destroyed&&t.destroy(e)})(null==(y=n)?void 0:y.getLastStream(),u),P-=o,o=0)}catch(t){w("error while clearing resources of `uploadFile` task, err:",t)}})),e)throw e;const n=(E().parts_info||[]).map(t=>({eTag:t.etag,partNumber:t.part_number})),[o,r]=await A(bt.call(this,{bucket:d,key:h,uploadId:m,parts:n}));if(o||!r)throw C({type:exports.UploadEventType.CompleteMultipartUploadFailed}),o;if(C({type:exports.UploadEventType.CompleteMultipartUploadSucceed}),I(B.completeMultipartUploadSucceed),await(async()=>{})(),this.opts.enableCRC&&r.data.HashCrc64ecma&&function(t){var e,a,n;const o=(null==(e=t.file_info)?void 0:e.file_size)||0;let i="0";const c=null!=(a=null==(n=t.parts_info)||null==n.sort?void 0:n.sort((t,e)=>t.part_number-e.part_number))?a:[];for(const t of c)i=X(i,t.hash_crc64ecma,Math.min(t.part_size,o-t.offset));return i}(E())!==r.data.HashCrc64ecma)throw new T("crc of entire file mismatch.");return r})());if(z||!F)throw j(exports.DataTransferType.Failed),z;return j(exports.DataTransferType.Succeed),F}var St,Et,Ct,Bt,It,Rt,Pt,At,Ot,Dt,Mt,jt,Nt,_t,Ut,Lt,zt,Ft,Gt,qt,Kt,Vt,$t,Ht,Wt,Jt,Qt,Xt,Yt,Zt,te,ee,ae,ne;async function oe(t){const e="string"==typeof t?{key:t}:t,a=R(e.headers);e.headers=a;const n={};return e.versionId&&(n.versionId=e.versionId),L(e,["ifMatch","ifModifiedSince","ifNoneMatch","ifUnmodifiedSince","ssecAlgorithm","ssecKey","ssecKeyMD5"]),this._fetchObject(t,"HEAD",n,(null==e?void 0:e.headers)||{},void 0,{handleResponse:t=>{const e={...t.headers,ReplicationStatus:t.headers[tt.HeaderReplicationStatus]},a=it(t.headers);return a&&(e.RestoreInfo=a),e}})}async function ie(t){const{uploadId:e,partNumber:a}=t,n=R(t.headers);if(t.headers=n,L(t,["copySourceRange","copySourceSSECAlgorithm","copySourceSSECKey","copySourceSSECKeyMD5","ssecAlgorithm","ssecKey","ssecKeyMD5","trafficLimit"]),t.srcBucket&&t.srcKey){var o;let e=ot(t.srcBucket,t.srcKey);t.srcVersionID&&(e+="?versionId="+t.srcVersionID),n["x-tos-copy-source"]=null!=(o=n["x-tos-copy-source"])?o:e}if(null==t.copySourceRange&&(null!=t.copySourceRangeStart||null!=t.copySourceRangeEnd)){var i;const e=`bytes=${null!=t.copySourceRangeStart?""+t.copySourceRangeStart:""}-${null!=t.copySourceRangeEnd?""+t.copySourceRangeEnd:""}`;n["x-tos-copy-source-range"]=null!=(i=n["x-tos-copy-source-range"])?i:e}const[c,s]=await A(this._fetchObject(t,"PUT",{partNumber:a,uploadId:e},n,void 0,{handleResponse:t=>({...t.data,SSECAlgorithm:t.headers[_.ssecAlgorithm],SSECKeyMD5:t.headers[_.ssecKeyMD5]})}));if(c||!s||!s.data.ETag)throw c;return s}async function ce(t){const e=R(t.headers);if(t.headers=e,L(t,["cacheControl","contentDisposition","contentEncoding","contentLanguage","contentType","expires","copySourceIfMatch","copySourceIfModifiedSince","copySourceIfNoneMatch","copySourceIfUnmodifiedSince","copySourceSSECAlgorithm","copySourceSSECKey","copySourceSSECKeyMD5","acl","grantFullControl","grantRead","grantReadAcp","grantWriteAcp","ssecAlgorithm","ssecKey","ssecKeyMD5","serverSideEncryption","metadataDirective","meta","websiteRedirectLocation","storageClass","trafficLimit","forbidOverwrite","ifMatch"]),t.srcBucket&&t.srcKey){var a;let n=ot(t.srcBucket,t.srcKey);t.srcVersionID&&(n+="?versionId="+t.srcVersionID),e["x-tos-copy-source"]=null!=(a=e["x-tos-copy-source"])?a:n}const[n,o]=await A(this._fetchObject(t,"PUT",{},e));if(n||!o||!o.data.ETag)throw n;return o}(St=exports.ACLType||(exports.ACLType={})).ACLPrivate="private",St.ACLPublicRead="public-read",St.ACLPublicReadWrite="public-read-write",St.ACLAuthenticatedRead="authenticated-read",St.ACLBucketOwnerRead="bucket-owner-read",St.ACLBucketOwnerFullControl="bucket-owner-full-control",St.ACLBucketOwnerEntrusted="bucket-owner-entrusted",St.ACLDefault="default",(Et=exports.StorageClassType||(exports.StorageClassType={})).StorageClassStandard="STANDARD",Et.StorageClassIa="IA",Et.StorageClassArchiveFr="ARCHIVE_FR",Et.StorageClassColdArchive="COLD_ARCHIVE",Et.StorageClassIntelligentTiering="INTELLIGENT_TIERING",Et.StorageClassArchive="ARCHIVE",Et.StorageClassDeepColdArchive="DEEP_COLD_ARCHIVE",(Ct=exports.MetadataDirectiveType||(exports.MetadataDirectiveType={})).MetadataDirectiveCopy="COPY",Ct.MetadataDirectiveReplace="REPLACE",(Bt=exports.AzRedundancyType||(exports.AzRedundancyType={})).AzRedundancySingleAz="single-az",Bt.AzRedundancyMultiAz="multi-az",(It=exports.PermissionType||(exports.PermissionType={})).PermissionRead="READ",It.PermissionWrite="WRITE",It.PermissionReadAcp="READ_ACP",It.PermissionWriteAcp="WRITE_ACP",It.PermissionFullControl="FULL_CONTROL",It.PermissionReadNONLIST="READ_NON_LIST",(Rt=exports.GranteeType||(exports.GranteeType={})).GranteeGroup="Group",Rt.GranteeUser="CanonicalUser",(Pt=exports.CannedType||(exports.CannedType={})).CannedAllUsers="AllUsers",Pt.CannedAuthenticatedUsers="AuthenticatedUsers",(At=exports.HttpMethodType||(exports.HttpMethodType={})).HttpMethodGet="GET",At.HttpMethodPut="PUT",At.HttpMethodPost="POST",At.HttpMethodDelete="DELETE",At.HttpMethodHead="HEAD",(Ot=exports.StorageClassInheritDirectiveType||(exports.StorageClassInheritDirectiveType={})).StorageClassInheritDirectiveDestinationBucket="DESTINATION_BUCKET",Ot.StorageClassInheritDirectiveSourceObject="SOURCE_OBJECT",(Dt=exports.ReplicationStatusType||(exports.ReplicationStatusType={})).Complete="COMPLETE",Dt.Pending="PENDING",Dt.Failed="FAILED",Dt.Replica="REPLICA",(Mt=exports.LifecycleStatusType||(exports.LifecycleStatusType={})).Enabled="Enabled",Mt.Disabled="Disabled",(jt=exports.RedirectType||(exports.RedirectType={})).Mirror="Mirror",jt.Async="Async",(Nt=exports.StatusType||(exports.StatusType={})).Enabled="Enabled",Nt.Disabled="Disabled",(_t=exports.TierType||(exports.TierType={})).TierStandard="Standard",_t.TierExpedited="Expedited",_t.TierBulk="Bulk",(Ut=exports.VersioningStatusType||(exports.VersioningStatusType={})).Enabled="Enabled",Ut.Suspended="Suspended",Ut.NotSet="",Ut.Enable="Enabled",Ut.Disable="",(Lt=exports.AccessPointStatusType||(exports.AccessPointStatusType={})).Ready="READY",Lt.Creating="CREATING",Lt.Created="CREATED",Lt.Deleting="DELETING",(zt=exports.TransferAccelerationStatusType||(exports.TransferAccelerationStatusType={})).Activating="AccelerationActivating",zt.Activated="AccelerationActivated",zt.Terminated="AccelerationTerminated",(Ft=exports.MRAPMirrorBackRedirectPolicyType||(exports.MRAPMirrorBackRedirectPolicyType={})).ClosestFirst="Closest-First",Ft.LatestFirst="Latest-First",(Gt=exports.WorkflowExecutionStateType||(exports.WorkflowExecutionStateType={})).Success="Success",Gt.Running="Running",Gt.Submitted="Submitted",Gt.Failed="Failed",(qt=exports.FileCompressFlatten||(exports.FileCompressFlatten={}))[qt.KeepStructure=0]="KeepStructure",qt[qt.FlattenAll=1]="FlattenAll",qt[qt.PrefixAsDirectory=2]="PrefixAsDirectory",qt[qt.PrefixContentsOnly=3]="PrefixContentsOnly",(Kt=exports.FileUncompressPrefixReplaced||(exports.FileUncompressPrefixReplaced={}))[Kt.NoExtraPrefix=0]="NoExtraPrefix",Kt[Kt.WithArchiveName=1]="WithArchiveName",Kt[Kt.FullArchivePath=2]="FullArchivePath",(Vt=exports.AccessPointStatus||(exports.AccessPointStatus={})).Enable="enable",Vt.Disable="disable",Vt.Creating="creating",Vt.Deleting="deleting",($t=exports.AcceleratorPrefetchJobStatus||(exports.AcceleratorPrefetchJobStatus={})).Null="NULL",$t.Idle="IDLE",$t.Running="RUNNING",$t.Stopping="STOPPING",$t.Complete="COMPLETE",(Ht=exports.AuditJobStateType||(exports.AuditJobStateType={})).Submitted="Submitted",Ht.Running="Running",Ht.Success="Success",Ht.Failed="Failed",Ht.Paused="Paused",Ht.Canceled="Canceled",(Wt=exports.AuditScanType||(exports.AuditScanType={})).Manifest="Manifest",Wt.Scan="Scan",(Jt=exports.AuditType||(exports.AuditType={})).Image="image",Jt.Video="video",Jt.Audio="audio",(Qt=exports.CallbackTriggerModeType||(exports.CallbackTriggerModeType={})).Freeze="freeze",Qt.Sensitive="sensitive",Qt.Failure="failure",(Xt=exports.FreezeModeType||(exports.FreezeModeType={})).Archive="archive",Xt.Private="private",(Yt=exports.TemplateTagType||(exports.TemplateTagType={})).AudioConvert="AudioConvert",Yt.Transcode="Transcode",(Zt=exports.AudioContainerFormatType||(exports.AudioContainerFormatType={})).Wav="wav",Zt.Mp3="mp3",Zt.Aac="aac",Zt.Flac="flac",Zt.Oga="oga",Zt.Ac3="ac3",Zt.Opus="opus",function(t){t.Mp4="mp4",t.Ts="ts"}(te||(te={})),(ee=exports.SampleFormatType||(exports.SampleFormatType={})).Fltp="fltp",ee.S16p="s16p",ee.S32p="s32p",ee.S16="s16",ee.S32="s32",(exports.DataType||(exports.DataType={})).DataTypeFloat32="float32",(ae=exports.DistanceMetricType||(exports.DistanceMetricType={})).DistanceMetricEuclidean="euclidean",ae.DistanceMetricCosine="cosine",(ne=exports.ResumableCopyEventType||(exports.ResumableCopyEventType={}))[ne.CreateMultipartUploadSucceed=1]="CreateMultipartUploadSucceed",ne[ne.CreateMultipartUploadFailed=2]="CreateMultipartUploadFailed",ne[ne.UploadPartCopySucceed=3]="UploadPartCopySucceed",ne[ne.UploadPartCopyFailed=4]="UploadPartCopyFailed",ne[ne.UploadPartCopyAborted=5]="UploadPartCopyAborted",ne[ne.CompleteMultipartUploadSucceed=6]="CompleteMultipartUploadSucceed",ne[ne.CompleteMultipartUploadFailed=7]="CompleteMultipartUploadFailed";const se=[403,404,405];async function re(t){var e,a,n;const{cancelToken:o}=t,i=()=>o&&!!o.reason,{data:c}=await oe.call(this,{bucket:t.srcBucket,key:t.srcKey,versionId:t.srcVersionId}),s=c.etag,r=+c["content-length"],u=await(async()=>"object"==typeof t.checkpoint?{record:t.checkpoint}:{})();await(async()=>{var t;if(null!=(t=u.record)&&t.copy_source_object_info){var e;const{last_modified:t,object_size:a}=null==(e=u.record)?void 0:e.copy_source_object_info;c["last-modified"]===t&&+c["content-length"]===a||(console.warn(`The file has been modified since ${new Date(t)}, so the checkpoint file is invalid, and specified file will be uploaded again.`),delete u.record)}})();const p=H(r,t.partSize||(null==(e=u.record)?void 0:e.part_size)||20971520,!0);u.record&&u.record.part_size!==p&&(console.warn("The partSize param does not equal the partSize in checkpoint file, so the checkpoint file is invalid, and specified file will be uploaded again."),delete u.record);let l=t.bucket||this.opts.bucket||"";const d=t.key;let m="",f=[];const y=function(t,e){const a=[];for(let n=0;;++n){const o=n*e,i=Math.min(e,t-o);if(a.push({offset:o,partSize:i,partNumber:n+1}),(n+1)*e>=t)break}return a}(r,p);let g=((null==(a=u.record)?void 0:a.parts_info)||[]).filter(t=>t.is_completed).reduce((t,e)=>t+e.copy_source_range_end-e.copy_source_range_start+1,0);const x=(null==(n=u.record)?void 0:n.parts_info)||[],k=new Map;x.forEach(t=>k.set(t.part_number,t));const w=()=>({bucket:l,key:d,part_size:p,upload_id:m,parts_info:x,copy_source_object_info:{last_modified:c["last-modified"],etag:c.etag,hash_crc64ecma:c["x-tos-hash-crc64ecma"]||"",object_size:+c["content-length"]}}),S=e=>{if(!t.copyEventListener)return;const a={bucket:l,uploadId:m,key:d,...e};u.filePath&&(a.checkpointFile=u.filePath),t.copyEventListener(a)};let E;!function(t){t[t.start=1]="start",t[t.uploadPartSucceed=2]="uploadPartSucceed",t[t.completeMultipartUploadSucceed=3]="completeMultipartUploadSucceed"}(E||(E={}));const C=e=>{t.progress&&(g===r&&e===E.uploadPartSucceed||t.progress(e===E.start&&0===r?0:r?g/r:1,w()))},B=K(async()=>{}),I=async(t,e)=>{let a=k.get(t.partNumber);const n=t.offset,o=Math.min(t.offset+p-1,r-1);a||(a={part_number:t.partNumber,copy_source_range_start:n,copy_source_range_end:o,is_completed:!1,etag:""},x.push(a),k.set(a.part_number,a)),e.err||(a.is_completed=!0,a.etag=e.res.ETag),await B();const i={partNumber:a.part_number,copySourceRangeEnd:a.copy_source_range_end,copySourceRangeStart:a.copy_source_range_start};if(e.err){const t=e.err;let a=exports.ResumableCopyEventType.UploadPartCopyFailed;return t instanceof b&&se.includes(t.statusCode)&&(a=exports.ResumableCopyEventType.UploadPartCopyAborted),void S({type:a,err:t,copyPartInfo:i})}i.etag=e.res.ETag,g+=i.copySourceRangeEnd-i.copySourceRangeStart+1,S({type:exports.ResumableCopyEventType.UploadPartCopySucceed,copyPartInfo:i}),C(E.uploadPartSucceed)};if(u.record){l=u.record.bucket,m=u.record.upload_id;const t=new Set((u.record.parts_info||[]).filter(t=>t.is_completed).map(t=>t.part_number));f=y.filter(e=>!t.has(e.partNumber))}else{try{const{data:e}=await $.call(this,h(t));if(i())throw new v("cancel uploadFile");var R;l=e.Bucket,m=e.UploadId,u.filePathIsPlaceholder&&(u.filePath=null==(R=u.filePath)?void 0:R.replace("@@checkpoint-file-placeholder@@",[(P={...t,bucket:l}).srcBucket,P.srcKey,P.srcVersionId,P.bucket,P.key,"copy"].filter(Boolean).join(".").replace(/[\\/]/g,""))),S({type:exports.ResumableCopyEventType.CreateMultipartUploadSucceed})}catch(t){const e=t;throw S({type:exports.ResumableCopyEventType.CreateMultipartUploadFailed,err:e}),e}f=y}var P;return C(E.start),0===r?(async()=>{let e=ot(t.srcBucket,t.srcKey);t.srcVersionId&&(e+="?versionId="+t.srcVersionId);const a={...t.headers,"x-tos-copy-source":e,"x-tos-copy-source-if-match":s},[n,o]=await A(ce.call(this,{bucket:t.bucket,key:t.key,headers:a,trafficLimit:t.trafficLimit}));if(n||!o)throw S({type:exports.ResumableCopyEventType.UploadPartCopyFailed}),n;return C(E.completeMultipartUploadSucceed),S({type:exports.ResumableCopyEventType.UploadPartCopySucceed,copyPartInfo:{partNumber:0,copySourceRangeStart:0,copySourceRangeEnd:0}}),S({type:exports.ResumableCopyEventType.CompleteMultipartUploadSucceed}),{...o,data:{ETag:o.headers.etag||"",Bucket:l,Key:d,Location:`http${this.opts.secure?"s":""}://${l}.${this.opts.endpoint}/${d}`,VersionID:o.headers["x-tos-version-id"],HashCrc64ecma:o.headers["x-tos-hash-crc64ecma"]}}})():(async()=>{let e=null,a=0;if(await Promise.all(Array.from({length:t.taskNum||1}).map(async()=>{for(;;){const n=a++;if(n>=f.length)return;const o=f[n];try{let e=ot(t.srcBucket,t.srcKey);t.srcVersionId&&(e+="?versionId="+t.srcVersionId);const a=`bytes=${o.offset}-${o.offset+o.partSize-1}`,n={...t.headers,"x-tos-copy-source":e,"x-tos-copy-source-if-match":s,"x-tos-copy-source-range":a};o.partSize||delete n["x-tos-copy-source-range"];const{data:c}=await ie.call(this,{bucket:l,key:d,uploadId:m,partNumber:o.partNumber,headers:n,trafficLimit:t.trafficLimit});if(i())throw new v("cancel resumableCopyObject");await I(o,{res:c})}catch(t){const a=t;if(ue(a))throw a;if(i())throw new v("cancel resumableCopyObject");e||(e=a),await I(o,{err:a})}}})),e)throw e;const n=(w().parts_info||[]).map(t=>({eTag:t.etag,partNumber:t.part_number})),[o,c]=await A(bt.call(this,{bucket:l,key:d,uploadId:m,parts:n}));if(o||!c)throw S({type:exports.ResumableCopyEventType.CompleteMultipartUploadFailed}),o;S({type:exports.ResumableCopyEventType.CompleteMultipartUploadSucceed}),C(E.completeMultipartUploadSucceed);const r=w().copy_source_object_info.hash_crc64ecma,u=c.data.HashCrc64ecma;if(this.opts.enableCRC&&r&&u&&r!==u)throw new T(`validate file crc64 failed. Expect crc64 ${r}, actual crc64 ${u}. Please try again.`);return await(async()=>{})(),c})()}function ue(t){return t instanceof v}async function pe(t){const e="string"==typeof t?{key:t}:t,a={};e.versionId&&(a.versionId=e.versionId);const n=R(null==e?void 0:e.headers),o=(null==e?void 0:e.response)||{};return Object.keys(o).forEach(t=>{const e=o[t];null!=e&&(a["response-"+t]=e)}),this._fetchObject(t,"GET",a,n,void 0,{axiosOpts:{responseType:"arraybuffer"}})}const le=["blob"];async function de(t){const e="string"==typeof t?{key:t}:t,a=R(e.headers);e.headers=a;const n=e.dataType||"stream";e.dataType=n,function(t){let e="node",a=[];if(e="browser",a=le,!a.includes(t))throw new T(`The value of \`dataType\` only supports \`${a.join(" | ")}\` in browser environment`)}(n);const o={},i=(null==e?void 0:e.response)||{};if(Object.keys(i).forEach(t=>{const e=i[t];null!=e&&(o["response-"+t]=e)}),function(t,e,a){function n(t,a){null==e[t]&&(e[t]=a)}a.length&&a.forEach(e=>{const a=U[e];if(!a)throw new T(`\`${e}\` isn't in keys of \`requestQueryMap\``);const o=t[e];if(null==o)return;if("string"==typeof a)return n(a,""+o);if(Array.isArray(a))return n(a[0],a[1](o));const i=a(o);Object.entries(i).forEach(([t,e])=>{n(t,e)})})}(e,o,["versionId","process","saveBucket","saveObject","responseCacheControl","responseContentDisposition","responseContentEncoding","responseContentLanguage","responseContentType","responseExpires"]),L(e,["ifMatch","ifModifiedSince","ifNoneMatch","ifUnmodifiedSince","ssecAlgorithm","ssecKey","ssecKeyMD5","range","trafficLimit"]),null==e.range&&(null!=e.rangeStart||null!=e.rangeEnd)){var c;const t=`bytes=${null!=e.rangeStart?""+e.rangeStart:""}-${null!=e.rangeEnd?""+e.rangeEnd:""}`;a.range=null!=(c=a.range)?c:t}let s=0,r=-1;const{dataTransferStatusChange:u,progress:p}=e,l=(t,e=0)=>{if(e<0)return;if(!u&&!p)return;s+=e,null==u||u({type:t,rwOnceBytes:e,consumedBytes:s,totalBytes:r});const a=r<0?0:0===r?t===exports.DataTransferType.Succeed?1:0:s/r;1===a?t===exports.DataTransferType.Succeed&&(null==p||p(a)):null==p||p(a)};l(exports.DataTransferType.Started);const[d,h]=await A(this._fetchObject(t,"GET",o,a,void 0,{axiosOpts:{responseType:"arraybuffer",onDownloadProgress:t=>{r=t.total,l(exports.DataTransferType.Rw,t.loaded-s)}}}));if(d||!h)throw l(exports.DataTransferType.Failed),d;let m=h.headers,f=h.data;r=+(m["content-length"]||0),"blob"===n&&(f=new Blob([h.data],{type:m["content-type"]})),l(exports.DataTransferType.Succeed);const y={...h,data:{content:f,etag:m.etag||"",lastModified:m["last-modified"]||"",hashCrc64ecma:m["x-tos-hash-crc64ecma"]||"",ReplicationStatus:m[tt.HeaderReplicationStatus]}},g=it(m);return g&&(y.data.RestoreInfo=g),y}async function he(t){throw new T("getObjectToFile doesn't support in browser environment")}var me;async function fe(t){throw new T("`downloadFile` is not supported in browser environment")}function ye(t){return!t||80===t||443===t}(me=exports.DownloadEventType||(exports.DownloadEventType={}))[me.CreateTempFileSucceed=1]="CreateTempFileSucceed",me[me.CreateTempFileFailed=2]="CreateTempFileFailed",me[me.DownloadPartSucceed=3]="DownloadPartSucceed",me[me.DownloadPartFailed=4]="DownloadPartFailed",me[me.DownloadPartAborted=5]="DownloadPartAborted",me[me.RenameTempFileSucceed=6]="RenameTempFileSucceed",me[me.RenameTempFileFailed=7]="RenameTempFileFailed";const ge="request";class xe{constructor(t,e){this.options=void 0,this.credentials=void 0,this.signature=(t,e,a)=>{a||(a=this.credentials);const n=[],o=this.credentialString(t.datetime);return n.push(this.options.algorithm+" Credential="+a.GetAccessKey()+"/"+o),n.push("SignedHeaders="+this.signedHeaders(t)),n.push("Signature="+this.authorization(t,a,0)),n.join(", ")},this.signatureHeader=(t,e,a)=>{t.datetime=this.getDateTime();const n=new Map;t.headers||(t.headers={}),t.headers.host=""+t.host,ye(t.port)||(t.headers.host+=":"+t.port),t.endpoints&&(t.headers.host=`${this.options.bucket}.${t.endpoints}`),n.set("host",t.headers.host),n.set("x-tos-date",t.datetime),n.set("x-tos-content-sha256",this.hexEncodedBodyHash()),this.options.securityToken&&n.set("x-tos-security-token",this.options.securityToken),n.forEach((e,a)=>{a.startsWith("x-tos")&&(t.headers[a]=e)}),t.path=this.getEncodePath(t.path);const o=this.signature(t,0,a);return n.set("authorization",o),n},this.gnrCopySig=(t,e)=>({key:"",value:""}),this.getSignature=(t,e)=>({key:"",value:""}),this.getSignatureQuery=(t,e)=>{t.datetime=this.getDateTime(),t.headers||(t.headers={}),t.headers.host=""+t.host,ye(t.port)||(t.headers.host+=":"+t.port),t.path=this.getEncodePath(t.path),t.endpoints&&(t.headers.host=`${this.options.bucket}.${t.endpoints}`),t.headers["X-Tos-Date"]=t.datetime;const a=this.credentialString(t.datetime),n={...t.query||{},"X-Tos-Algorithm":this.options.algorithm,"X-Tos-Content-Sha256":this.hexEncodedBodyHash(),"X-Tos-Credential":this.credentials.GetAccessKey()+"/"+a,"X-Tos-Date":t.datetime,"X-Tos-Expires":""+e,"X-Tos-SignedHeaders":this.signedHeaders(t)};return this.options.securityToken&&(n["X-Tos-Security-Token"]=this.options.securityToken),t.query=I(n),n["X-Tos-Signature"]=this.authorization(t,this.credentials,e),n},this.getSignaturePolicyQuery=(t,e)=>{t.datetime=this.getDateTime();const a=this.credentialString(t.datetime),n={"X-Tos-Algorithm":this.options.algorithm,"X-Tos-Credential":this.credentials.GetAccessKey()+"/"+a,"X-Tos-Date":t.datetime,"X-Tos-Expires":""+e,"X-Tos-Policy":yt(ft(JSON.stringify(t.policy),"utf-8"),"base64")};return this.options.securityToken&&(n["X-Tos-Security-Token"]=this.options.securityToken),t.query=I(n),n["X-Tos-Signature"]=this.authorization(t,this.credentials,e),n},this.hexEncodedBodyHash=()=>"UNSIGNED-PAYLOAD",this.authorization=(t,e,a)=>{if(!t.datetime)return"";const n=this.getSigningKey(e,t.datetime.substr(0,8));return dt(n,this.stringToSign(t.datetime,t),"hex")},this.getDateTime=()=>new Date((new Date).toUTCString()).toISOString().replace(/\..+/,"").replace(/-/g,"").replace(/:/g,"")+"Z",this.credentialString=t=>this.createScope(t.substr(0,8),this.options.region,this.options.serviceName),this.createScope=(t,e,a)=>[t.substr(0,8),e,a,ge].join("/"),this.getSigningKey=(t,e)=>{const a=dt(t.GetSecretKey(),e),n=dt(a,this.options.region),o=dt(n,this.options.serviceName);return dt(o,ge)},this.stringToSign=(t,e)=>{if(!this.options.algorithm)return"";const a=[];a.push(this.options.algorithm),a.push(t),a.push(this.credentialString(t));const n="policy"in e?this.canonicalStringPolicy(e):this.canonicalString(e);return a.push(this.hexEncodedHash(n)),a.join("\n")},this.hexEncodedHash=t=>ht(t,"hex"),this.canonicalString=t=>{const e=[];return e.push(t.method),e.push(t.path),e.push(this.getEncodePath(t.query,!1)),e.push(this.canonicalHeaders(t)+"\n"),e.push(this.signedHeaders(t)),e.push(this.hexEncodedBodyHash()),e.join("\n")},this.canonicalStringPolicy=t=>{const e=[];return e.push(this.getEncodePath(t.query,!1)),e.push(this.hexEncodedBodyHash()),e.join("\n")},this.canonicalHeaders=t=>{const e=[],a=be(t.headers);for(let n of a){const a=t.headers[n];n=n.toLowerCase(),e.push(n+":"+this.canonicalHeaderValues(a.toString()))}return e.join("\n")},this.canonicalHeaderValues=t=>t.replace(/\s+/g," ").replace(/^\s+|\s+$/g,""),this.signedHeaders=t=>{const e=[],a=be(t.headers);for(let t of a)t=t.toLowerCase(),e.push(t);return e.sort().join(";")},this.options=t,this.credentials=e}getEncodePath(t,e=!0){if(!t)return"";let a=t;return e&&(a=t.replace(/%2F/g,"/")),a=a.replace(/\(/g,"%28"),a=a.replace(/\)/g,"%29"),a=a.replace(/!/g,"%21"),a=a.replace(/\*/g,"%2A"),a=a.replace(/\'/g,"%27"),a}}class ke{constructor(t,e,a){this.securityToken=void 0,this.secretAccessKey=void 0,this.accessKeyId=void 0,this.accessKeyId=a,this.secretAccessKey=e,this.securityToken=t}GetAccessKey(){return this.accessKeyId}GetSecretKey(){return this.secretAccessKey}}function be(t){const e=[];return Object.keys(t||{}).forEach(a=>{("host"===a||a.startsWith("x-tos-"))&&null!=t[a]&&e.push(a)}),e.sort()}let Te="wexin";function ve(t,{transformRequestOption:e=(t=>t)}={}){const a=function(){switch(!0){case"object"==typeof wx:return Te="wexin",wx.request.bind(wx);case"object"==typeof swan:return Te="baidu",swan.request.bind(swan);case"object"==typeof dd:return Te="dd",dd.httpRequest.bind(dd);case"object"==typeof my:return Te="alipay",(my.request||my.httpRequest).bind(my);default:return wx.request.bind(wx)}}();return new Promise((n,o)=>{let i,c=t.data,s=t.headers;const r={method:t.method&&t.method.toUpperCase()||"GET",url:y(g(t.baseURL,t.url),t.params,t.paramsSerializer),timeout:t.timeout,success:e=>{const a=function(t,e,a){const n=t.statusCode||t.status;let o="";return 200===n?o="OK":400===n&&(o="Bad Request"),{data:t.data,status:n,statusText:o,headers:t.header||t.headers,config:e,request:a}}(e,t,r);f(n,o,a)},fail:e=>{!function(t,e,a){switch(Te){case"wexin":-1!==t.errMsg.indexOf("request:fail abort")?e(x("Request aborted",a,"ECONNABORTED","")):-1!==t.errMsg.indexOf("timeout")?e(x("timeout of "+a.timeout+"ms exceeded",a,"ECONNABORTED","")):e(x("Network Error",a,null,""));break;case"dd":case"alipay":[14,19].includes(t.error)?e(x("Request aborted",a,"ECONNABORTED","",t)):[13].includes(t.error)?e(x("timeout of "+a.timeout+"ms exceeded",a,"ECONNABORTED","",t)):e(x("Network Error",a,null,"",t));break;case"baidu":e(x("Network Error",a,null,""))}}(e,o,t)},complete(){i=void 0}};if(t.auth){const[e,a]=[t.auth.username||"",t.auth.password||""];s.Authorization="Basic "+function(t){const e=String(t);let a,n,o=0,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="";for(;e.charAt(0|o)||(i="=",o%1);c+=i.charAt(63&a>>8-o%1*8)){if(n=e.charCodeAt(o+=3/4),n>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");a=a<<8|n}return c}(e+":"+a)}m.forEach(s,(function(t,e){const a=e.toLowerCase();(void 0===c&&"content-type"===a||"referer"===a)&&delete s[e]})),r.header=s,t.responseType&&(r.responseType=t.responseType),t.cancelToken&&t.cancelToken.promise.then((function(t){i&&(i.abort(),o(t),i=void 0)})),(t=>{try{return"string"==typeof t&&t.length&&(t=JSON.parse(t))&&"[object Object]"===Object.prototype.toString.call(t)}catch(t){return!1}})(c)&&(c=JSON.parse(c)),void 0!==c&&(r.data=c),i=a(e(function(t){var e;return["alipay","dd"].includes(Te)&&(t.headers=t.header,delete t.header,"dd"===Te&&"GET"!==t.method&&"application/json"===(null==(e=t.headers)?void 0:e["Content-Type"])&&"[object Object]"===Object.prototype.toString.call(t.data)&&(t.data=JSON.stringify(t.data))),t}(r)))})}class we{constructor(t){this.opts=void 0,this.axiosInst=void 0,this.userAgent=void 0,this.httpAgent=void 0,this.httpsAgent=void 0,this.getObjectPath=t=>{const e="string"!=typeof t&&t.bucket||this.opts.bucket,a="string"==typeof t?t:t.key;if(!e)throw new T("Must provide bucket param");return`/${e}/${encodeURIComponent(a)}`},this.setObjectContentTypeHeader=(t,e)=>{if(null!=e["content-type"])return;let a="application/octet-stream";const n=(t=>"string"==typeof t?t:t.key)(t);this.opts.autoRecognizeContentType&&(a=function(t){const e=t.lastIndexOf(".");if(e<=0)return;const a=t.slice(e+1).toLowerCase();return J[a]}(n)||a),a&&(e["content-type"]=a)},this.getNormalDataFromError=F,this.opts=this.normalizeOpts(t),this.userAgent=this.getUserAgent(),this.axiosInst=(t=>{const e=a.create();e.defaults.auth=void 0,e.defaults.responseType="json",e.defaults.params=void 0,e.defaults.headers={},e.defaults.withCredentials=!1,e.defaults.maxContentLength=-1,e.defaults.maxBodyLength=-1,e.defaults.maxRedirects=0,e.defaults.validateStatus=function(t){return t>=200&&t<300},e.defaults.decompress=!1,e.defaults.transitional={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},e.interceptors.request.use(t=>t.headers?(Object.keys(t.headers).forEach(e=>{st.includes(e.toLowerCase())&&delete t.headers[e]}),t):t);const n=t=>{var e;return t.headers=t.headers||t.header||(null==t||null==(e=t.response)?void 0:e.headers)||{},t};function o(t){Object.entries(t).forEach(([e,a])=>{const[n,o]=function(t){try{return[null,decodeURI(a)]}catch(t){return[t,null]}}();if(n||null==o||o===a)return;let i=[];const c=(""+a).match(/./gu),s=o.match(/./gu);for(let t=0,e=0;t<s.length;){const a=s[t];if(a===c[e]){i.push(a),++t,++e;continue}const n=encodeURIComponent(a);a.length>1||a.charCodeAt(0)>=128?i.push(a):i.push(n),++t,e+=n.length}t[e]=i.join("")})}return e.interceptors.response.use(n,t=>(n(t),Promise.reject(t))),e.interceptors.response.use(t=>t.headers?(o(t.headers),t):t,async t=>{var e;if(!a.isAxiosError(t))return Promise.reject(t);const n=null==(e=t.response)?void 0:e.headers;return n?(o(n),Promise.reject(t)):Promise.reject(t)}),e.interceptors.response.use(void 0,async a=>{var n;const{config:o}=a;if(!o)return Promise.reject(a);o.__retryConfig__||(o.__retryConfig__={});const i=o.__retryConfig__,c=null!=(n=i.retryCount)?n:0;let s=o.data;if(!((function(t){var e;return!t.response&&Boolean(t.code)||t.response&&!(null!=(e=t.response.headers)&&e["x-tos-request-id"])}(a)||function(t){if(!t.response)return!1;const{status:e}=t.response;return 429===e||408===e||e>=500}(a))&&c<t))return Promise.reject(a);const r=o.__retrySignature__;if(r){const{signOpt:t,sigInst:e}=r;e.signatureHeader(t).forEach((t,e)=>{o.headers[e]=t})}w("retryConfig: ",o);const u={...o,data:s,__retryConfig__:{...i,retryCount:c+1}};return null==i.beforeRetry||i.beforeRetry(),e(u)}),e})(this.opts.maxRetryCount)}normalizeOpts(t){var e,a;["accessKeyId","accessKeySecret","stsToken","region","endpoint"].forEach(e=>{const a=t[e];"string"==typeof a&&(t[e]=a.trim())});const n=["accessKeyId","accessKeySecret","region"].filter(e=>!t[e]).join(", ");if(n)throw new T(`lack params: ${n}.`);const o=t.endpoint||`tos-${t.region}.volces.com`;if(!o)throw new T("the value of param region is invalid, correct values are cn-beijing, cn-nantong etc.");if(["tos-s3-cn-beijing.volces.com","tos-s3-cn-guangzhou.volces.com","tos-s3-cn-shanghai.volces.com","tos-s3-ap-southeast-1.volces.com"].includes(o))throw new T("do not support s3 endpoint, please use tos endpoint.");const i=null==t.secure||!!t.secure,c=(t,e)=>null==t?e:t;if(null!=(e=t.enableCRC)&&e)throw new T("not support crc in browser environment");return{...t,endpoint:o,secure:i,enableVerifySSL:c(t.enableVerifySSL,!0),autoRecognizeContentType:c(t.autoRecognizeContentType,!0),requestTimeout:c(t.requestTimeout,12e4),connectionTimeout:c(t.connectionTimeout,1e4),maxConnections:c(t.maxConnections,1024),idleConnectionTime:c(t.idleConnectionTime,3e4),maxRetryCount:c(t.maxRetryCount,3),enableCRC:null!=(a=t.enableCRC)&&a,requestAdapter:Se()}}getUserAgent(){return"ve-tos-browserjs-sdk/v2.9.0"}async fetch(t,e,n,o,i,c){const s=(null==c?void 0:c.handleResponse)||(t=>t.data);if(i&&(null==c?void 0:c.needMd5)){const t=mt(JSON.stringify(i),"base64");o["content-md5"]=t}const[r,u]=(()=>null!=c&&c.subdomainBucket&&this.opts.forcePathStyle?[this.opts.endpoint,`/${c.subdomainBucket}${e}`]:null!=c&&c.subdomainBucket&&!this.opts.isCustomDomain?/^(\d|:)/.test(this.opts.endpoint)?[this.opts.endpoint,`/${c.subdomainBucket}${e}`]:[`${null==c?void 0:c.subdomainBucket}.${this.opts.endpoint}`,e]:[this.opts.endpoint,e])();e=u,o=(t=>{const e={};return Object.entries(t).forEach(([t,a])=>{e[t]=(""+a).match(/./gu).map(t=>t.length>1||t.charCodeAt(0)>=128?encodeURIComponent(t):t).join("")}),e})(o);const p={endpoints:void 0,bucket:"",method:t,headers:{...o},path:e,query:I(n),host:r},l=new ke(this.opts.stsToken,this.opts.accessKeySecret,this.opts.accessKeyId),d=new xe({algorithm:"TOS4-HMAC-SHA256",region:this.opts.region,serviceName:(null==c?void 0:c.serviceName)||"tos",bucket:"",securityToken:this.opts.stsToken},l),h=d.signatureHeader(p),m={...o},f={method:t,baseURL:`http${this.opts.secure?"s":""}://${r}`,url:e,params:n,headers:m,data:i||""};h.forEach((t,e)=>{f.headers[e]=t});const y=P(this.opts.proxy);if(null!=y&&y.url&&!this.opts.proxyHost)f.baseURL=y.url,null!=y&&y.needProxyParams&&(f.params["x-proxy-tos-host"]=r,delete m.host);else if(this.opts.proxyHost){if(!this.opts.proxyPort)throw new T("The `proxyPort` is required if `proxyHost` is truly.");f.proxy={host:this.opts.proxyHost,port:this.opts.proxyPort,protocol:"http"}}m["user-agent"]=this.userAgent,this.opts.requestTimeout>0&&Infinity!==this.opts.requestTimeout&&(f.timeout=this.opts.requestTimeout);try{const t={...f};delete t.httpAgent,delete t.httpsAgent,w("reqOpts: ",t);const e=await this.axiosInst({maxBodyLength:Infinity,maxContentLength:Infinity,adapter:this.opts.requestAdapter,...f,...(null==c?void 0:c.axiosOpts)||{},__retrySignature__:{signOpt:p,sigInst:d}});return{data:s(e),statusCode:e.status,headers:e.headers,requestId:e.headers["x-tos-request-id"],id2:e.headers["x-tos-id-2"]}}catch(t){var g,x,k,v;if(a.isAxiosError(t)&&(null!=(g=t.response)&&null!=(x=g.headers)&&x["x-tos-request-id"]||null!=(k=t.response)&&null!=(v=k.data)&&v.requestId)){const e=t.response;throw w("TosServerError response: ",e),new b(e)}throw w("err: ",t),t}}async fetchBucket(t,e,a,n,o,i){const c=t||this.opts.bucket;if(!c)throw new T("Must provide bucket param");return V(c,this.opts.isCustomDomain),this.fetch(e,"/",a,n,o,{...i,subdomainBucket:c})}async _fetchObject(t,e,a,n,o,i){const c="string"!=typeof t&&t.bucket||this.opts.bucket,s="string"==typeof t?t:t.key;if(!c)throw new T("Must provide bucket param");return V(c,this.opts.isCustomDomain),et(s),this.fetch(e,"/"+encodeURIComponent(s),a,n,o,{...i,subdomainBucket:c})}getSignatureQuery(t){const e=new ke(this.opts.stsToken,this.opts.accessKeySecret,this.opts.accessKeyId),a=new xe({algorithm:"TOS4-HMAC-SHA256",region:this.opts.endpoint,serviceName:"tos",bucket:t.bucket,securityToken:this.opts.stsToken},e);return"policy"in t?a.getSignaturePolicyQuery({policy:t.policy},t.expires):a.getSignatureQuery({method:t.method,path:t.path,endpoints:t.subdomain?t.endpoint:void 0,host:t.endpoint,query:t.query},t.expires)}normalizeBucketInput(t){return"string"==typeof t?{bucket:t}:t}normalizeObjectInput(t){return"string"==typeof t?{key:t}:t}}function Se(){if("undefined"==typeof window||void 0===window.location)switch(!0){case"undefined"!=typeof wx:case"undefined"!=typeof swan:case"undefined"!=typeof dd:case"undefined"!=typeof my:return ve;case"undefined"!=typeof uni:return k;default:return}}async function Ee(t={}){const{...e}=t,a=await this.fetchBucket(t.bucket,"GET",C(e),{}),n=S(a.data);return n("CommonPrefixes"),n("Contents"),n("Versions"),n("DeleteMarkers"),a}async function Ce(t={}){const{...e}=t,a=await this.fetchBucket(t.bucket,"GET",C({versions:"",...e}),{}),n=S(a.data);return n("CommonPrefixes"),n("Versions"),n("DeleteMarkers"),a}async function Be(t={}){const{listOnlyOnce:e=!1}=t;let a;if(t.maxKeys||(t.maxKeys=1e3),e)a=await Ie.call(this,t);else{const e=t.maxKeys;let n={...t,maxKeys:e};for(;;){const t=await Ie.call(this,n);if(null==a?a=t:(a={...t,data:a.data},a.data.KeyCount+=t.data.KeyCount,a.data.IsTruncated=t.data.IsTruncated,a.data.NextContinuationToken=t.data.NextContinuationToken,a.data.Contents=a.data.Contents.concat(t.data.Contents),a.data.CommonPrefixes=a.data.CommonPrefixes.concat(t.data.CommonPrefixes)),!t.data.IsTruncated||a.data.KeyCount>=e)break;n.continuationToken=t.data.NextContinuationToken,n.maxKeys=n.maxKeys-t.data.KeyCount}}return a}async function Ie(t){const{...e}=t,a=await this.fetchBucket(t.bucket,"GET",{"list-type":2,...C(e)},{}),n=S(a.data);return n("CommonPrefixes"),n("Contents"),a}class Re extends we{modifyAxiosInst(){this.axiosInst.interceptors.request.use(t=>{const e=t.headers||{};return delete e.authorization,e.host=this.parsedPolicyUrlVal.host,t.baseURL=this.parsedPolicyUrlVal.origin,t.paramsSerializer=t=>{const e=z(t);return[this.parsedPolicyUrlVal.search,e].filter(t=>t.trim()).join("&")},t})}constructor(t){super({...t,bucket:"fake-bucket",region:"fake-region",accessKeyId:"fake-accessKeyId",accessKeySecret:"fake-accessKeySecret",endpoint:"fake-endpoint.com"}),this.shareLinkClientOpts=void 0,this.parsedPolicyUrlVal=void 0,this.headObject=oe,this.getObjectV2=de,this.listObjects=Ee,this.listObjectsType2=Be,this.listObjectVersions=Ce,this.downloadFile=fe,this.shareLinkClientOpts=t,this.parsedPolicyUrlVal=this.initParsedPolicyUrlVal(),this.modifyAxiosInst()}initParsedPolicyUrlVal(){const t=this.shareLinkClientOpts.policyUrl.match(/(https?:\/\/(?:[^@]+@)?([^/?]+))[^?]*\?(.+)/);if(!t)throw new T("the `policyUrl` param is invalid");return{origin:t[1],host:t[2],search:t[3]}}}async function Pe(t={}){const e={};(null==t?void 0:t.projectName)&&L({...t,headers:e},["projectName"]);const a=await this.fetch("GET","/",{},e);return S(a.data)("Buckets"),a}async function Ae(t){const e=t.bucket||this.opts.bucket;if(e){if(e.length<3||e.length>63)throw new T("invalid bucket name, the length must be [3, 63]");if(!/^([a-z]|-|\d)+$/.test(e))throw new T("invalid bucket name, the character set is illegal");if(/^-/.test(e)||/-$/.test(e))throw new T("invalid bucket name, the bucket name can be neither starting with '-' nor ending with '-'")}const a=t.headers=R(t.headers);return L(t,["acl","grantFullControl","grantRead","grantReadAcp","grantWrite","grantWriteAcp","storageClass","azRedundancy","bucketType","tagging"]),(null==t?void 0:t.projectName)&&L(t,["projectName"]),await this.fetchBucket(t.bucket,"PUT",{},a)}async function Oe(t){return this.fetchBucket(t,"DELETE",{},{})}async function De(t){return this.fetchBucket(t,"HEAD",{},{},void 0,{handleResponse:t=>({...t.headers,ProjectName:t.headers[tt.HeaderProjectName]})})}async function Me(t){if(!t)throw new T("input is required");const{bucket:e}=t;V(e,this.opts.isCustomDomain);try{return 200===(await De.call(this,e)).statusCode}catch(t){if(t instanceof b&&"0006-00000001"===t.ec)return!1;throw t}}async function je(t){const{bucket:e,storageClass:a}=t;return this.fetchBucket(e,"PUT",{storageClass:""},{"x-tos-storage-class":a})}async function Ne(t){const{bucket:e}=t;return this.fetchBucket(e,"GET",{bucketInfo:""},{})}async function _e(t){const e={};return t.acl&&(e["x-tos-acl"]=t.acl),await this.fetchBucket(t.bucket,"PUT",{acl:""},e,t.aclBody,{needMd5:!0})}async function Ue(t){const e=await this.fetchBucket(t,"GET",{acl:""},{});return S(e.data)("Grants"),e}async function Le(t){const{bucket:e,TLS:a}=t;return await this.fetchBucket(e,"PUT",{httpsConfig:""},{},{TLS:a})}async function ze(t){return await this.fetchBucket(t,"GET",{httpsConfig:""},{})}async function Fe(t){return Ge.call(this,t)}async function Ge(t){const e=(t=this.normalizeObjectInput(t)).headers=R(t.headers);L(t,["contentLength","contentMD5","contentSHA256","cacheControl","contentDisposition","contentEncoding","contentLanguage","contentType","expires","acl","grantFullControl","grantRead","grantReadAcp","grantWrite","grantWriteAcp","ssecAlgorithm","ssecKey","ssecKeyMD5","serverSideEncryption","serverSideDataEncryption","meta","websiteRedirectLocation","storageClass","trafficLimit","callback","callbackVar","forbidOverwrite","ifMatch"]),this.setObjectContentTypeHeader(t,e);const a=at(t.body,e),n=null!=a;n||!t.dataTransferStatusChange&&!t.progress||console.warn("Don't get totalSize of putObject's body, the `dataTransferStatusChange` and `progress` callback will not trigger. You can use `putObjectFromFile` instead");let o=0;const{dataTransferStatusChange:i,progress:c}=t,s=(t,e=0)=>{if(!n||e<0)return;if(!i&&!c)return;o+=e,null==i||i({type:t,rwOnceBytes:e,consumedBytes:o,totalBytes:a});const s=0===a?t===exports.DataTransferType.Succeed?1:0:o/a;1===s?t===exports.DataTransferType.Succeed&&(null==c||c(s)):null==c||c(s)},r=await nt({body:t.body,dataTransferCallback:t=>s(exports.DataTransferType.Rw,t),makeRetryStream:t.makeRetryStream,enableCRC:this.opts.enableCRC,rateLimiter:t.rateLimiter});s(exports.DataTransferType.Started);const[u,p]=await A((async()=>{const a=await this._fetchObject(t,"PUT",{},e,r.body||"",{handleResponse:e=>{var a;const n={...e.headers};return null!=(a=t)&&a.callback&&e.data&&(n.CallbackResult=""+JSON.stringify(e.data)),n},axiosOpts:{__retryConfig__:{beforeRetry:()=>{o=0,null==r.beforeRetry||r.beforeRetry()},makeRetryStream:r.makeRetryStream},onUploadProgress:t=>{s(exports.DataTransferType.Rw,t.loaded-o)}}});return this.opts.enableCRC&&r.crc&&G(r.crc,a.headers),a})());if(u||!p)throw s(exports.DataTransferType.Failed),u;return s(exports.DataTransferType.Succeed),p}async function qe(t){throw R(t.headers),new T("putObjectFromFile doesn't support in browser environment")}async function Ke(t){const e=t.headers=R(t.headers);return L(t,["acl","grantFullControl","grantRead","grantReadAcp","grantWriteAcp","ssecAlgorithm","ssecKey","ssecKeyMD5","meta","storageClass"]),await this._fetchObject(t,"POST",{fetch:""},e,{URL:t.url,IgnoreSameKey:t.ignoreSameKey,ContentMD5:t.contentMD5},{needMd5:!0})}async function Ve(t){const e=t.headers=R(t.headers);return L(t,["acl","grantFullControl","grantRead","grantReadAcp","grantWriteAcp","ssecAlgorithm","ssecKey","ssecKeyMD5","meta","storageClass"]),await this._fetchObject(t,"POST",{fetchTask:""},e,{URL:t.url,IgnoreSameKey:t.ignoreSameKey,ContentMD5:t.contentMD5,Object:t.key},{needMd5:!0})}async function $e(t){const e=await this.fetchBucket(t.bucket,"GET",{fetchTask:"",taskId:t.taskId},{},{},{needMd5:!0});return e.data.Task&&(e.data.Task.Meta=e.data.Task.UserMeta),e}function He(t){et(t);const e="string"==typeof t?{key:t}:t,a=e.alternativeEndpoint||this.opts.endpoint,n=!e.alternativeEndpoint&&!e.isCustomDomain,o=e.bucket||this.opts.bucket||"";if(n&&!o)throw new T("Must provide bucket param");const[i,c,s]=(()=>{const t=encodeURIComponent(e.key),i=e.key.split("/").map(t=>encodeURIComponent(t)).join("/");return n?[`${o}.${a}`,"/"+i,"/"+t]:[a,"/"+i,"/"+t]})(),r=e.query||{},u=(t,e)=>{null==r[t]&&null!=e&&(r[t]=e)},p=e.response||{};Object.keys(p).forEach(t=>{const e=t,a=C(e);u("response-"+a,p[e])}),e.versionId&&u("versionId",e.versionId);const l=this.getSignatureQuery({bucket:o,method:e.method||"GET",path:s,endpoint:a,subdomain:n,expires:e.expires||1800,query:r}),d=P(this.opts.proxy);let h=`http${this.opts.secure?"s":""}://${i}`;return null!=d&&d.url&&(h=d.url.replace(/\/+$/g,""),null!=d&&d.needProxyParams&&(l["x-proxy-tos-host"]=i)),`${h}${c}?${Object.keys(l).map(t=>`${encodeURIComponent(t)}=${encodeURIComponent(l[t])}`).join("&")}`}async function We(t){if(!t)throw new T("input is required");try{return 200===(await oe.call(this,{bucket:t.bucket,key:t.key,versionId:t.versionId})).statusCode}catch(t){if(t instanceof b&&404===t.statusCode)return!1;throw t}}async function Je(t){const e="string"==typeof t?{key:t}:t,a={};return e.versionId&&(a.versionId=e.versionId),e.skipTrash&&(a.skipTrash=e.skipTrash),e.recursive&&(a.recursive=e.recursive),await this._fetchObject(t,"DELETE",a,{},{},{handleResponse:t=>t.headers})}async function Qe(t){return t.headers=t.headers||{},L(t,["recursiveMkdir","forbidOverwrite"]),this._fetchObject(t,"PUT",{rename:"",name:t.newKey},t.headers,"")}async function Xe(t){const e={Quiet:t.quiet,Objects:t.objects.map(t=>({Key:t.key,VersionId:t.versionId}))},a={delete:""};t.skipTrash&&(a.skipTrash=t.skipTrash),t.recursive&&(a.recursive=t.recursive);const n=await this.fetchBucket(t.bucket,"POST",a,{},e),o=S(n.data);return o("Deleted"),o("Error"),n}async function Ye(t){const e="string"==typeof t?{key:t}:t,a={acl:""};e.versionId&&(a.versionId=e.versionId);const n=await this._fetchObject(t,"GET",a,{});return S(n.data)("Grants"),n}async function Ze(t){const e=t.headers=R(t.headers),a={acl:""};return t.versionId&&(a.versionId=t.versionId),L(t,["acl"]),this._fetchObject(t,"PUT",a,e,t.aclBody)}async function ta(t){return this._fetchObject(t,"DELETE",{uploadId:t.uploadId},{})}async function ea(t={}){const{...e}=t,a=await this.fetchBucket(t.bucket,"GET",{uploads:"",...C(e)},{}),n=S(a.data);return n("Uploads"),n("CommonPrefixes"),a}async function aa(t){const e=t=this.normalizeObjectInput(t),a=t.headers=R(t.headers);L(t,["contentLength","cacheControl","contentDisposition","contentEncoding","contentLanguage","contentType","expires","acl","grantFullControl","grantRead","grantReadAcp","grantWriteAcp","meta","websiteRedirectLocation","storageClass","trafficLimit"]),this.setObjectContentTypeHeader(t,a);const n=at(t.body,a),o=null!=n;if(!o)throw new T("appendObject needs to know the content length in advance");if(a["content-length"]=a["content-length"]||""+n,this.opts.enableCRC&&0!==t.offset&&!t.preHashCrc64ecma)throw new T("must provide preHashCrc64ecma if enableCRC is true and offset is non-zero");let i=0;const{dataTransferStatusChange:c,progress:s}=t,r=(t,e=0)=>{if(!o||e<0)return;if(!c&&!s)return;i+=e,null==c||c({type:t,rwOnceBytes:e,consumedBytes:i,totalBytes:n});const a=0===n?t===exports.DataTransferType.Succeed?1:0:i/n;1===a?t===exports.DataTransferType.Succeed&&(null==s||s(a)):null==s||s(a)},u=await nt({body:t.body,dataTransferCallback:t=>r(exports.DataTransferType.Rw,t),makeRetryStream:void 0,enableCRC:this.opts.enableCRC,rateLimiter:t.rateLimiter});r(exports.DataTransferType.Started);const[p,l]=await A((async()=>{const o=await this._fetchObject(t,"POST",{append:"",offset:e.offset},a,u.body||"",{handleResponse:t=>({...t.headers,nextAppendOffset:+t.headers["x-tos-next-append-offset"],hashCrc64ecma:t.headers["x-tos-hash-crc64ecma"]}),axiosOpts:{__retryConfig__:{beforeRetry:()=>{i=0,null==u.beforeRetry||u.beforeRetry()},makeRetryStream:u.makeRetryStream},onUploadProgress:t=>{r(exports.DataTransferType.Rw,t.loaded-i)}}});return this.opts.enableCRC&&u.crc&&G(X(e.preHashCrc64ecma||"0",u.crc.getCrc64(),n),o.headers),o})());if(p||!l)throw r(exports.DataTransferType.Failed),p;return r(exports.DataTransferType.Succeed),l}async function na(t){const e="string"==typeof t?{key:t}:t,a=e.headers=R(e.headers);L(e,["cacheControl","contentDisposition","contentEncoding","contentLanguage","contentType","expires","meta"]);const n={metadata:""};return e.versionId&&(n.versionId=e.versionId),this._fetchObject(t,"POST",n,a)}async function oa(t){et(t),t=this.normalizeObjectInput(t);const{expiresIn:e=3600,key:a}=t,n=t.bucket||this.opts.bucket,o={...t.fields},i=[...t.conditions||[]];if(!n)throw new T("Must provide bucket param");const c=this.opts.accessKeySecret,s=new Date,r=ia({date:new Date(s.valueOf()+1e3*e),type:"ISO"}),u=ia(),p=u.substring(0,8),l="tos",d="request",h=dt(c,p),m=dt(h,this.opts.region),f=dt(m,l),y=dt(f,d),g={key:a,"x-tos-algorithm":"TOS4-HMAC-SHA256","x-tos-date":u,"x-tos-credential":[this.opts.accessKeyId,p,this.opts.region,l,d].join("/")};this.opts.stsToken&&(g["x-tos-security-token"]=this.opts.stsToken),i.push({bucket:n}),Object.entries(g).forEach(([t,e])=>{o[t]=e}),Object.entries(o).forEach(([t,e])=>{i.push({[t]:""+e})});const x=JSON.stringify({expiration:r,conditions:i}),k=yt(ft(x,"utf-8"),"base64"),b=dt(y,k,"hex");return o.policy=k,o["x-tos-signature"]=b,o}function ia(t){const{date:e=new Date,type:a="Z"}=t||{};return"ISO"===a?e.toISOString():e.toISOString().replace(/\..+/,"").replace(/-/g,"").replace(/:/g,"")+"Z"}const ca={getBucketCustomDomain:!0,getBucketIntelligenttiering:!0,getBucketInventory:!0,listBucketInventory:!0,getBucketMirrorBack:!0,getBucketNotification:!0,getBucketPolicy:!0,getBucketRealTimeLog:!0,getBucketReplication:!0,getBucketTagging:!0,getBucketWebsite:!0};function sa(t,e){const{enableCatchEmptyServerError:a,methodKey:n,defaultResponse:o}=e;if(t instanceof b)if(a){if(404===t.statusCode)return F(o,t)}else if(void 0===a&&404===t.statusCode&&ca[n])return F(o,t);throw t}async function ra(t){return!this.opts.enableOptimizeMethodBehavior&&void 0!==this.opts.enableOptimizeMethodBehavior||t.policy.Statement.length?await this.fetchBucket(t.bucket,"PUT",{policy:""},{},t.policy,{needMd5:!0}):pa.call(this,t.bucket)}async function ua(t){try{const e=await this.fetchBucket(t,"GET",{policy:""},{});return e.data.Statement.forEach(t=>{const e=S(t);Object.keys(t.Condition||{}).forEach(a=>{Object.keys(t.Condition[a]).forEach(t=>{e(`Condition["${a}"]["${t}"]`)})})}),e}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketPolicy",defaultResponse:{Statement:[],Version:"2012-10-17"}})}}async function pa(t){return this.fetchBucket(t,"DELETE",{policy:""},{})}async function la(t){return this.fetchBucket(t,"GET",{versioning:""},{})}async function da(t){return this.fetchBucket(t.bucket,"PUT",{versioning:""},{},{Status:t.status})}function ha(t){const e=ma.call(this,t);fa(t.conditions);const a=`http${this.opts.secure?"s":""}://${t.alternativeEndpoint||(t.isCustomDomain?this.opts.endpoint:`${e.bucket}.${this.opts.endpoint}`)}`,n=M(this.getSignatureQuery({bucket:e.bucket,expires:e.expires,policy:{conditions:e.conditions}}));return{getSignedURLForList:t=>{const e=M(t),o=[n,e].filter(Boolean).join("&");return`${a}?${o}`},getSignedURLForGetOrHead:(t,e)=>{const o=M(e),i=[n,o].filter(Boolean).join("&"),c=t.split("/").map(t=>encodeURIComponent(t)).join("/");return`${a}/${c}?${i}`},signedQuery:n}}function ma(t){const e=t.bucket||this.opts.bucket;if(!e)throw new T("Must provide bucket param");fa(t.conditions);const a=t.conditions.map(t=>[t.operator||"eq","$key",t.value]);return a.push(["eq","$bucket",e]),{bucket:e,expires:t.expires||3600,conditions:a}}function fa(t){if(t.length<1)throw new T("The `conditions` field of `PreSignedPolicyURLInput` must has one item at least");for(const e of t){if("key"!==e.key)throw new T("The `key` field of `PolicySignatureCondition` must be `'key'`");if(e.operator&&"eq"!==e.operator&&"starts-with"!==e.operator)throw new T("The `operator` field of `PolicySignatureCondition` must be `'eq'` or `'starts-with'`")}}async function ya(t){const{bucket:e}=t;return this.fetchBucket(e,"GET",{location:""},{})}async function ga(t){try{const{bucket:e}=t;return await this.fetchBucket(e,"GET",{cors:""},{})}catch(t){return sa(t,{defaultResponse:{CORSRules:[]},enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketCORS"})}}async function xa(t){const{bucket:e,CORSRules:a}=t;return this.opts.enableOptimizeMethodBehavior&&!a.length?ka.call(this,{bucket:e}):this.fetchBucket(e,"PUT",{cors:""},{},{CORSRules:a})}async function ka(t){const{bucket:e}=t;return this.fetchBucket(e,"DELETE",{cors:""},{})}async function ba(t){const{bucket:e,rules:a}=t;if(this.opts.enableOptimizeMethodBehavior&&!a.length)return va.call(this,{bucket:e});const n={};return L({...t,headers:n},["allowSameActionOverlap"]),this.fetchBucket(e,"PUT",{lifecycle:""},n,{Rules:a})}async function Ta(t){try{const{bucket:e}=t;return await this.fetchBucket(e,"GET",{lifecycle:""},{},{},{handleResponse:t=>({AllowSameActionOverlap:t.headers["x-tos-allow-same-action-overlap"],Rules:t.data.Rules})})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketLifecycle",defaultResponse:{Rules:[]}})}}async function va(t){const{bucket:e}=t;return this.fetchBucket(e,"DELETE",{lifecycle:""},{})}async function wa(t){const{bucket:e,rule:a}=t;return this.fetchBucket(e,"PUT",{encryption:""},{"Content-MD5":pt(JSON.stringify({Rule:a}),"base64")},{Rule:a})}async function Sa(t){const{bucket:e}=t;return this.fetchBucket(e,"GET",{encryption:""},{})}async function Ea(t){const{bucket:e}=t;return this.fetchBucket(e,"DELETE",{encryption:""},{})}async function Ca(t){const{bucket:e,rules:a}=t;return this.opts.enableOptimizeMethodBehavior&&!a.length?Ia.call(this,{bucket:e}):this.fetchBucket(e,"PUT",{mirror:""},{},{Rules:a})}async function Ba(t){const{bucket:e}=t;try{return await this.fetchBucket(e,"GET",{mirror:""},{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketMirrorBack",defaultResponse:{Rules:[]}})}}async function Ia(t){const{bucket:e}=t;return this.fetchBucket(e,"DELETE",{mirror:""},{})}async function Ra(t){const{tagSet:e,versionId:a}=t,n=R({versionId:a});return this._fetchObject(t,"PUT",{tagging:"",...n},{},{TagSet:e})}async function Pa(t){const{versionId:e}=t,a=R({versionId:e}),n=await this._fetchObject(t,"GET",{tagging:"",...a},{});return S(n.data.TagSet)("Tags"),n}async function Aa(t){const{versionId:e}=t,a=R({versionId:e});return this._fetchObject(t,"DELETE",{tagging:"",...a},{})}async function Oa(t){const{bucket:e,rules:a,role:n}=t;return this.opts.enableOptimizeMethodBehavior&&!a.length?Ma.call(this,{bucket:e}):this.fetchBucket(e,"PUT",{replication:""},{},{Role:n,Rules:a})}async function Da(t){const{bucket:e,progress:a,ruleId:n}=t,o={replication:"",progress:a||""};null!=n&&(o["rule-id"]=""+n);try{return await this.fetchBucket(e,"GET",o,{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketReplication",defaultResponse:{Rules:[],Role:""}})}}async function Ma(t){const{bucket:e}=t;return this.fetchBucket(e,"DELETE",{replication:""},{})}async function ja(t){const{bucket:e,...a}=t,n=B(a);return this.fetchBucket(e,"PUT",{website:""},{},{...n})}async function Na(t){const{bucket:e}=t;try{return this.fetchBucket(e,"GET",{website:""},{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketWebsite",defaultResponse:{RoutingRules:[]}})}}async function _a(t){const{bucket:e}=t;return this.fetchBucket(e,"DELETE",{website:""},{})}async function Ua(t){const{bucket:e,...a}=t,n=B(a);return this.fetchBucket(e,"PUT",{notification:""},{},{...n})}async function La(t){const{bucket:e}=t;try{return await this.fetchBucket(e,"GET",{notification:""},{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketNotification",defaultResponse:{CloudFunctionConfigurations:[],RocketMQConfigurations:[]}})}}async function za(t){const{bucket:e,...a}=t,n=B(a);return this.fetchBucket(e,"PUT",{customdomain:""},{},{...n})}async function Fa(t){try{const{bucket:e}=t;return await this.fetchBucket(e,"GET",{customdomain:""},{})}catch(t){return sa(t,{defaultResponse:{CustomDomainRules:[]},enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketCustomDomain"})}}async function Ga(t){const{bucket:e,customDomain:a}=t;return this.fetchBucket(e,"DELETE",{customdomain:a},{})}async function qa(t){const{bucket:e,...a}=t,n=B(a);return this.fetchBucket(e,"PUT",{realtimeLog:""},{},{...n})}async function Ka(t){const{bucket:e}=t;try{return await this.fetchBucket(e,"GET",{realtimeLog:""},{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketRealTimeLog",defaultResponse:{}})}}async function Va(t){const{bucket:e}=t;return this.fetchBucket(e,"DELETE",{realtimeLog:""},{})}var $a,Ha,Wa,Ja,Qa,Xa,Ya;async function Za(t){try{return await this.fetchBucket(t.bucket,"GET",{inventory:"",id:t.id},{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketInventory",defaultResponse:void 0})}}async function tn(t){const e={inventory:"",...t.continuationToken?{"continuation-token":t.continuationToken}:null};try{return await this.fetchBucket(t.bucket,"GET",e,{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"listBucketInventory",defaultResponse:{InventoryConfigurations:[]}})}}async function en(t){return this.fetchBucket(t.bucket,"DELETE",{inventory:"",id:t.id},{})}function an(t){return this.fetchBucket(t.bucket,"PUT",{inventory:"",id:t.inventoryConfiguration.Id},{},t.inventoryConfiguration)}async function nn(t){const{accountId:e,...a}=t,n=B(a);return await this.fetch("POST","/jobs",{},{"x-tos-account-id":e},{...n})}async function on(t){const{accountId:e,maxResults:a=1e3,...n}=t;return await this.fetch("GET","/jobs",{maxResults:a,...n},{"x-tos-account-id":e},{},{axiosOpts:{paramsSerializer:z}})}async function cn(t){const{accountId:e,jobId:a,priority:n}=t;return await this.fetch("POST",`/jobs/${a}/priority`,{priority:n},{"x-tos-account-id":e},{},{needMd5:!0})}async function sn(t){const{accountId:e,jobId:a,requestedJobStatus:n,statusUpdateReason:o}=t;return await this.fetch("POST",`/jobs/${a}/status`,{requestedJobStatus:n,statusUpdateReason:o},{"x-tos-account-id":e},{},{needMd5:!0})}async function rn(t){const{accountId:e,JobId:a}=t;return await this.fetch("DELETE","/jobs/"+a,{},{"x-tos-account-id":e},{})}async function un(t){const{accountId:e,JobId:a}=t;return await this.fetch("GET","/jobs/"+a,{},{"x-tos-account-id":e},{})}async function pn(t){return await this.fetchBucket(t.bucket,"PUT",{tagging:""},{},t.tagging,{needMd5:!0})}async function ln({bucket:t}){try{return await this.fetchBucket(t,"GET",{tagging:""},{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketTagging",defaultResponse:{TagSet:{Tags:[]}}})}}async function dn({bucket:t}){return this.fetchBucket(t,"DELETE",{tagging:""},{})}async function hn(t){return await this.fetchBucket(t.bucket,"PUT",{payByTraffic:""},{},t.payByTraffic)}async function mn({bucket:t}){return await this.fetchBucket(t,"GET",{payByTraffic:""},{})}async function fn(t){const{bucket:e}=t;try{return await this.fetchBucket(e,"GET",{imageStyleBriefInfo:""},{})}catch(t){if(t instanceof b&&404===t.statusCode)return this.getNormalDataFromError({BucketName:e,ImageStyleBriefInfo:[]},t);throw t}}async function yn(t){try{return await this.fetchBucket(t,"GET",{imageStyle:""},{})}catch(t){if(t instanceof b&&404===t.statusCode)return this.getNormalDataFromError({ImageStyles:[]},t);throw t}}async function gn(t){try{const{bucket:e,styleName:a}=t;return await this.fetchBucket(e,"GET",{imageStyleContent:"",styleName:a},{})}catch(t){if(t instanceof b&&404===t.statusCode)return this.getNormalDataFromError({ImageStyles:[]},t);throw t}}async function xn(t,e){try{return await this.fetchBucket(t,"GET",{imageStyle:"",styleName:e},{})}catch(t){if(t instanceof b&&404===t.statusCode)return this.getNormalDataFromError(null,t);throw t}}async function kn(t){const{bucket:e,styleName:a,content:n,styleObjectPrefix:o}=t;try{return await this.fetchBucket(e,"PUT",{imageStyle:"",styleName:a,styleObjectPrefix:o},{},{Content:n})}catch(t){if(t instanceof b&&404===t.statusCode)return this.getNormalDataFromError(null,t);throw t}}async function bn(t){const{styleName:e,styleObjectPrefix:a,bucket:n}=t;try{return await this.fetchBucket(n,"DELETE",{imageStyle:"",styleName:e,styleObjectPrefix:a},{})}catch(t){if(t instanceof b&&404===t.statusCode)return this.getNormalDataFromError(null,t);throw t}}async function Tn(t,e){try{return await this.fetchBucket(t,"PUT",{originalImageProtect:""},{},e)}catch(t){if(t instanceof b&&404===t.statusCode)return this.getNormalDataFromError(null,t);throw t}}async function vn(t){try{return await this.fetchBucket(t,"GET",{originalImageProtect:""},{})}catch(t){if(t instanceof b&&404===t.statusCode)return this.getNormalDataFromError(null,t);throw t}}async function wn(t){const{bucket:e,Separator:a,SeparatorSuffix:n}=t;try{return await this.fetchBucket(e,"PUT",{imageStyleSeparator:""},{},{Separator:a,SeparatorSuffix:n})}catch(t){if(t instanceof b&&404===t.statusCode)return this.getNormalDataFromError(null,t);throw t}}async function Sn(t){try{return await this.fetchBucket(t,"GET",{imageStyleSeparator:""},{})}catch(t){if(t instanceof b&&404===t.statusCode)return this.getNormalDataFromError(null,t);throw t}}async function En(t){try{return await this.fetchBucket(t,"GET",{intelligenttiering:""},{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketIntelligenttiering",defaultResponse:{}})}}async function Cn(t){const{bucket:e,...a}=t,n=B(a);return this.fetchBucket(e,"PUT",{rename:""},{},{...n})}async function Bn(t){const{bucket:e}=t;return await this.fetchBucket(e,"GET",{rename:""},{})}async function In(t){const{bucket:e}=t;return this.fetchBucket(e,"DELETE",{rename:""},{})}async function Rn(t){const{versionId:e,...a}=t,n={restore:""};e&&(n.versionId=e);const o=B(a);return this._fetchObject(t,"POST",n,{},o)}async function Pn(t){const{accountId:e}=t;return await this.fetch("GET","/storagelens",{},{"x-tos-account-id":e},{},{axiosOpts:{paramsSerializer:z}})}async function An(t){const{accountId:e,Id:a}=t;return await this.fetch("DELETE","/storagelens",{id:a},{"x-tos-account-id":e},{},{needMd5:!0})}async function On(t){const{accountId:e,Id:a}=t;return await this.fetch("GET","/storagelens",{id:a},{"x-tos-account-id":e},{},{needMd5:!0})}async function Dn(t){const{accountId:e,Id:a,...n}=t;return await this.fetch("PUT","/storagelens",{id:a},{"x-tos-account-id":e},{...n,Id:a},{needMd5:!0})}async function Mn(t){const{bucket:e,...a}=t,n=B(a);return this.fetchBucket(e,"PUT",{notification_v2:""},{},{...n})}async function jn(t){const{bucket:e}=t;try{return await this.fetchBucket(e,"GET",{notification_v2:""},{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketNotificationType2",defaultResponse:{Rules:[]}})}}async function Nn(t){return _n.call(this,t)}async function _n(t){const e=t.headers=R(t.headers);return L(t,["symLinkTargetKey","symLinkTargetBucket","forbidOverwrite","acl","storageClass","meta"]),this._fetchObject(t,"PUT",{symlink:""},e,void 0,{handleResponse(t){const{headers:e}=t;return{VersionID:e["x-tos-version-id"]}}})}async function Un(t){return Ln.call(this,t)}async function Ln(t){const e={symlink:""};return t.versionId&&(e.versionId=t.versionId),this._fetchObject(t,"GET",e,{},void 0,{handleResponse:t=>{const{headers:e}=t;return{VersionID:e["x-tos-version-id"],SymlinkTargetKey:e["x-tos-symlink-target"],SymlinkTargetBucket:e["x-tos-symlink-bucket"],LastModified:e["last-modified"]}}})}async function zn(t){const{bucket:e,...a}=t,n=B(a);return this.fetchBucket(e,"PUT",{transferAcceleration:""},{},{...n})}async function Fn(t){try{const{bucket:e}=t,a={};return t.getStatus&&(a["x-tos-get-bucket-acceleration-status"]="true"),await this.fetchBucket(e,"GET",{transferAcceleration:""},a)}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketTransferAcceleration",defaultResponse:{TransferAccelerationConfiguration:{Enabled:"false",Status:exports.TransferAccelerationStatusType.Terminated}}})}}async function Gn(t){const{bucket:e,status:a}=t;return this.fetchBucket(e,"PUT",{accessmonitor:""},{},{Status:a})}async function qn(t){try{const{bucket:e}=t;return await this.fetchBucket(e,"GET",{accessmonitor:""},{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketAccessMonitor",defaultResponse:{}})}}async function Kn(t){const{accountId:e}=t;return await this.fetch("GET","/qospolicy",{},{"x-tos-account-id":e},{},{})}async function Vn(t){const{accountId:e,...a}=t;return await this.fetch("PUT","/qospolicy",{},{"x-tos-account-id":e},{...a},{})}async function $n(t){const{accountId:e}=t;return await this.fetch("DELETE","/qospolicy",{},{"x-tos-account-id":e},{},{})}async function Hn(t){const{accountId:e,name:a,regions:n}=t;return await this.fetch("POST","/mrap",{name:a},{"x-tos-account-id":e},{Name:a,Regions:n},{})}async function Wn(t){const{name:e,accountId:a}=t;return await this.fetch("GET","/mrap",{name:e},{"x-tos-account-id":a},{},{})}async function Jn(t){const{accountId:e,...a}=t;return await this.fetch("GET","/mrap",{...a},{"x-tos-account-id":e},{},{})}async function Qn(t){const{accountId:e,alias:a}=t;return await this.fetch("GET","/mrap/routes",{alias:a},{"x-tos-account-id":e})}async function Xn(t){const{name:e,accountId:a}=t;return await this.fetch("DELETE","/mrap",{name:e},{"x-tos-account-id":a})}async function Yn(t){const{routes:e,accountId:a,alias:n}=t;return await this.fetch("PATCH","/mrap/routes",{alias:n},{"x-tos-account-id":a},{Routes:e})}async function Zn(t){const{AccountId:e,MultiRegionAccessPointAlias:a,AcceleratorId:n}=t;return await this.fetch("PUT",`/accelerator/${n}/mrap/${a}`,{},{"x-tos-account-id":e},{},{})}async function to(t){const{AccountId:e,MultiRegionAccessPointAlias:a,AcceleratorId:n}=t;return await this.fetch("DELETE",`/accelerator/${n}/mrap/${a}`,{},{"x-tos-account-id":e},{},{})}async function eo(t){const{AccountId:e,AcceleratorId:a}=t;return await this.fetch("GET",`/accelerator/${a}/mrap`,{},{"x-tos-account-id":e},{},{})}async function ao(t){const{BucketAccountId:e,Name:a,AccountId:n,Bucket:o,NetworkOrigin:i,VpcId:c}=t;return await this.fetch("PUT","/accesspoint/"+a,{name:""},{"x-tos-account-id":n},{BucketAccountId:e,Bucket:o,NetworkOrigin:i,VpcId:c},{})}async function no(t){const{Name:e,AccountId:a}=t;return await this.fetch("GET","/accesspoint/"+e,{},{"x-tos-account-id":a},{},{})}async function oo(t){const{AccountId:e,...a}=t;return await this.fetch("GET","/accesspoint",{...a},{"x-tos-account-id":e},{},{})}async function io(t){const{Name:e,AccountId:a}=t;return await this.fetch("DELETE","/accesspoint/"+e,{},{"x-tos-account-id":a})}async function co(t){const{AccountId:e,AcceleratorAccountId:a,AccessPointName:n,AcceleratorId:o}=t;return await this.fetch("PUT",`/accesspoint/${n}/accelerator/${o}`,{},{"x-tos-account-id":e},{AcceleratorAccountId:a},{})}async function so(t){const{AccountId:e,AccessPointName:a,AcceleratorId:n}=t;return await this.fetch("DELETE",`/accesspoint/${a}/accelerator/${n}`,{},{"x-tos-account-id":e},{},{})}async function ro(t){const{AccountId:e,AcceleratorId:a,...n}=t;return await this.fetch("GET",`/accelerator/${a}/accesspoint`,{...n},{"x-tos-account-id":e},{},{})}async function uo(t){const{AccountId:e,...a}=t;return await this.fetch("POST","/accelerator",{name:""},{"x-tos-account-id":e},{...a},{})}async function po(t){const{Id:e,AccountId:a}=t;return await this.fetch("GET","/accelerator",{id:e},{"x-tos-account-id":a},{},{})}async function lo(t){const{AccountId:e,...a}=t;return await this.fetch("GET","/accelerator",{...a},{"x-tos-account-id":e},{},{})}async function ho(t){const{Id:e,AccountId:a}=t;return await this.fetch("DELETE","/accelerator",{id:e},{"x-tos-account-id":a})}async function mo(t){const{AccountId:e,...a}=t;return await this.fetch("GET","/accelerator/az",{...a},{"x-tos-account-id":e},{},{})}async function fo(t){const{AccountId:e,...a}=t;return await this.fetch("POST","/accelerator/prefetchJob",{acceleratorId:a.AcceleratorId},{"x-tos-account-id":e},{...a},{})}async function yo(t){const{AccountId:e,JobId:a}=t;return await this.fetch("GET","/accelerator/prefetchJob",{jobId:a},{"x-tos-account-id":e},{},{})}async function go(t){const{JobId:e,AccountId:a}=t;return await this.fetch("DELETE","/accelerator/prefetchJob",{jobId:e},{"x-tos-account-id":a})}async function xo(t){const{AccountId:e,AcceleratorId:a,...n}=t;return await this.fetch("GET","/accelerator/prefetchJob",{acceleratorId:a,...n},{"x-tos-account-id":e},{},{})}async function ko(t){const{AccountId:e,JobId:a,...n}=t;return await this.fetch("GET","/accelerator/prefetchRecord",{jobId:a,...n},{"x-tos-account-id":e},{},{})}async function bo(t){const{AccountId:e,Az:a}=t;return await this.fetch("GET","/accelerator/capacity",{az:a},{"x-tos-account-id":e},{},{})}async function To(t){const{AccountId:e,AccessPointName:a}=t;return await this.fetch("GET",`/accesspoint/${a}/accelerator`,{},{"x-tos-account-id":e},{},{})}!function(t){t.Daily="Daily",t.Weekly="Weekly",t.Once="Once"}($a||($a={})),function(t){t.All="All",t.Current="Current"}(Ha||(Ha={})),function(t){t.Size="Size",t.LastModifiedDat="LastModifiedDate",t.ETag="ETag",t.StorageClass="StorageClass",t.IsMultipartUploaded="IsMultipartUploaded",t.EncryptionStatus="EncryptionStatus",t.CRC64="CRC64",t.ReplicationStatus="ReplicationStatus",t.RetentionMode="RetentionMode",t.RetainUntilTimestamp="RetainUntilTimestamp",t.IntelligentTieringAccessTier="IntelligentTieringAccessTier"}(Wa||(Wa={})),function(t){t.StringEquals="StringEquals",t.StringNotEquals="StringNotEquals",t.StringEqualsIgnoreCase="StringEqualsIgnoreCase",t.StringNotEqualsIgnoreCase="StringNotEqualsIgnoreCase",t.StringLike="StringLike",t.StringNotLike="StringNotLike"}(Ja||(Ja={})),function(t){t.DateEquals="DateEquals",t.DateNotEquals="DateNotEquals",t.DateLessThan="DateLessThan",t.DateLessThanEquals="DateLessThanEquals",t.DateGreaterThan="DateGreaterThan",t.DateGreaterThanEquals="DateGreaterThanEquals"}(Qa||(Qa={})),function(t){t.IpAddress="IpAddress",t.NotIpAddress="NotIpAddress"}(Xa||(Xa={})),function(t){t.WritesQps="WritesQps",t.ReadsQps="ReadsQps",t.ListQps="ListQps",t.WritesRate="WritesRate",t.ReadsRate="ReadsRate"}(Ya||(Ya={}));const vo=async function(t){const{accountId:e,alias:a,rules:n}=t;return this.opts.enableOptimizeMethodBehavior&&!n.length?So.call(this,{accountId:e,alias:a}):await this.fetch("PUT","/mrap/mirror",{alias:a},{"x-tos-account-id":e},{Rules:n},{handleResponse:()=>({})})},wo=async function(t){const{accountId:e,alias:a}=t;try{const t=await this.fetch("GET","/mrap/mirror",{alias:a},{"x-tos-account-id":e},{},{});return S(t.data)("Rules"),t}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getMultiRegionAccessPointMirrorBack",defaultResponse:{Rules:[]}})}},So=async function(t){const{accountId:e,alias:a}=t;return await this.fetch("DELETE","/mrap/mirror",{alias:a},{"x-tos-account-id":e},{},{handleResponse:()=>({})})};async function Eo(t){const{bucket:e,enable:a}=t;return await this.fetchBucket(e,"PUT",{privateM3U8:""},{},{Enable:a})}async function Co(t){const{bucket:e}=t;try{return await this.fetchBucket(e,"GET",{privateM3U8:""},{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketPrivateM3U8",defaultResponse:{Enable:!1}})}}async function Bo(t){const{bucket:e,enable:a}=t;return await this.fetchBucket(e,"PUT",{blindWatermark:""},{},{Enable:a})}async function Io(t){const{bucket:e}=t;try{return await this.fetchBucket(e,"GET",{blindWatermark:""},{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketBlindWatermark",defaultResponse:{Enable:!1}})}}async function Ro(t){const{bucket:e,...a}=t,n=B(a);return this.fetchBucket(e,"PUT",{trash:""},{},{...n})}async function Po(t){const{bucket:e}=t;return await this.fetchBucket(e,"GET",{trash:""},{})}async function Ao(t){const{bucket:e,objectLockEnabled:a,rule:n}=t;return this.fetchBucket(e,"PUT",{"object-lock":""},{},{ObjectLockEnabled:a,Rule:n})}async function Oo(t){const{bucket:e}=t;try{return await this.fetchBucket(e,"GET",{"object-lock":""},{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketObjectLockConfiguration",defaultResponse:{}})}}async function Do(t){const{versionId:e,mode:a,retainUntilDate:n}=t,o={retention:""};return e&&(o.versionId=e),this._fetchObject(t,"PUT",o,{},{Mode:a,RetainUntilDate:n})}async function Mo(t){const{versionId:e}=t,a={retention:""};e&&(a.versionId=e);try{return await this._fetchObject(t,"GET",a,{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getObjectRetention",defaultResponse:{}})}}async function jo(t){const{bucket:e,role:a,rules:n}=t;return this.opts.enableOptimizeMethodBehavior&&!n.length?_o.call(this,{bucket:e}):this.fetchBucket(e,"PUT",{cdn_notification:""},{},{Role:a,Rules:n})}async function No(t){const{bucket:e}=t;try{return await this.fetchBucket(e,"GET",{cdn_notification:""},{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketCdnNotification",defaultResponse:{Rules:[],Role:""}})}}async function _o(t){const{bucket:e}=t;return await this.fetchBucket(e,"DELETE",{cdn_notification:""},{})}async function Uo(t){const{bucket:e,role:a,rules:n}=t;return this.opts.enableOptimizeMethodBehavior&&!n.length?zo.call(this,{bucket:e}):this.fetchBucket(e,"PUT",{workflow:""},{},{Role:a,Rules:n})}async function Lo(t){const{bucket:e}=t;try{return await this.fetchBucket(e,"GET",{workflow:""},{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketWorkflow",defaultResponse:{Rules:[]}})}}async function zo(t){const{bucket:e}=t,a=await this.fetchBucket(e,"DELETE",{workflow:""},{});return a.data||(a.data={}),a}async function Fo(t){const{bucket:e,executionId:a}=t;try{return await this.fetchBucket(e,"GET",{workflow_execution:"",id:a},{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketWorkflowExecution",defaultResponse:null})}}async function Go(t){const{bucket:e,workflowId:a,startTime:n,endTime:o,states:i,orderByTime:c,pageSize:s,pageToken:r}=t;try{const t={workflow_execution:""};return a&&(t.workflow_id=a),void 0!==n&&(t.start_time=n.toString()),void 0!==o&&(t.end_time=o.toString()),i&&(t.states=i),c&&(t.order_by_time=c),void 0!==s&&(t.page_size=s.toString()),r&&(t.page_token=r),await this.fetchBucket(e,"GET",t,{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"listBucketWorkflowExecution",defaultResponse:{Items:[]}})}}async function qo(t){const{bucket:e,Input:a,FileCompressConfig:n,Output:o}=t;return await this.fetchBucket(e,"POST",{file_jobs:"",job_type:"FileCompress"},{},{Input:a,FileCompressConfig:n,Output:o})}async function Ko(t){const{bucket:e,Input:a,FileUncompressConfig:n,Output:o}=t;return await this.fetchBucket(e,"POST",{file_jobs:"",job_type:"FileUncompress"},{},{Input:a,FileUncompressConfig:n,Output:o})}async function Vo(t){try{return await this.fetchBucket(t.bucket,"GET",{logging:""},{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketLogging",defaultResponse:void 0})}}function $o(t){return this.fetchBucket(t.bucket,"PUT",{logging:""},{},{LoggingEnabled:{TargetBucket:t.data.targetBucket,TargetPrefix:t.data.targetPrefix,Role:t.data.role}})}function Ho(t){return this.fetchBucket(t.bucket,"PUT",{logging:""},{},{})}async function Wo(t){var e;const{accountId:a,name:n,policy:o}=t;return!this.opts.enableOptimizeMethodBehavior||null!=(e=o.Statement)&&e.length?this.fetch("PUT",`/accesspoint/${n}/policy`,{},{"x-tos-account-id":a},o):Qo.call(this,{accountId:a,name:n})}async function Jo(t){const{accountId:e,name:a}=t;try{return await this.fetch("GET",`/accesspoint/${a}/policy`,{},{"x-tos-account-id":e},void 0,{handleResponse:t=>({Policy:t.data})})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getAccessPointPolicy",defaultResponse:{Policy:{Version:"2012-10-17",Statement:[]}}})}}async function Qo(t){const{accountId:e,name:a}=t;return this.fetch("DELETE",`/accesspoint/${a}/policy`,{},{"x-tos-account-id":e})}async function Xo(t){var e;const{accountId:a,name:n,policy:o}=t;return!this.opts.enableOptimizeMethodBehavior||null!=(e=o.Statement)&&e.length?await this.fetch("PUT",`/mrap/${n}/policy`,{},{"x-tos-account-id":a},o,{}):Zo.call(this,{accountId:a,name:n})}async function Yo(t){const{accountId:e,name:a}=t;try{return await this.fetch("GET",`/mrap/${a}/policy`,{},{"x-tos-account-id":e},void 0,{handleResponse:t=>({Policy:t.data})})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getMultiRegionAccessPointMirrorBack",defaultResponse:{Policy:{Version:"2012-10-17",Statement:[]}}})}}async function Zo(t){const{accountId:e,name:a}=t;return await this.fetch("DELETE",`/mrap/${a}/policy`,{},{"x-tos-account-id":e},{},{handleResponse:()=>({})})}async function ti(t){const{bucket:e}=t;try{return await this.fetchBucket(e,"GET",{audit:""},{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketAudit",defaultResponse:null})}}async function ei(t){const{bucket:e,action:a}=t;return await this.fetchBucket(e,"PUT",{action:a,audit:""},{})}async function ai(t){const{bucket:e,startTime:a,endTime:n,pageSize:o,pageToken:i}=t,c={job_type:"AuditStock"};return void 0!==a&&(c.start_time=a.toString()),void 0!==n&&(c.end_time=n.toString()),void 0!==o&&(c.page_size=o.toString()),void 0!==i&&(c.page_token=i),await this.fetchBucket(e,"GET",c,{})}async function ni(t){const{bucket:e,jobId:a}=t;try{return await this.fetchBucket(e,"GET",{job_type:"AuditStock",job_id:a},{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketAuditJob",defaultResponse:null})}}async function oi(t){const{bucket:e,job:a}=t;return await this.fetchBucket(e,"POST",{job_type:"AuditStock",audit_jobs:""},{},a)}async function ii(t){const{bucket:e,audit_type:a}=t;return this.fetchBucket(e,"GET",{type:a,audits:""},{})}async function ci(t){const{bucket:e,job:a}=t;return await this.fetchBucket(e,"POST",{increment_audit:""},{},{AuditConfiguration:a})}async function si(t){const{bucket:e,pageSize:a,pageToken:n,audiType:o}=t,i={increment_audits:"",audit_type:o};return void 0!==a&&(i.page_size=a.toString()),void 0!==n&&(i.page_token=n),await this.fetchBucket(e,"GET",i,{})}async function ri(t){const{bucket:e,ruleId:a}=t;try{return await this.fetchBucket(e,"GET",{increment_audit:"",rule_id:a},{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketIncrementAudits",defaultResponse:null})}}async function ui(t){const{bucket:e,ruleId:a}=t;return this.fetchBucket(e,"DELETE",{increment_audit:"",rule_id:a},{})}async function pi(t){const{bucket:e,jobType:a,startTime:n,endTime:o,pageSize:i,pageToken:c}=t,s={job_type:a};return void 0!==n&&(s.start_time=n.toString()),void 0!==o&&(s.end_time=o.toString()),void 0!==i&&(s.page_size=i.toString()),void 0!==c&&(s.page_token=c),await this.fetchBucket(e,"GET",s,{})}async function li(t){const{bucket:e,jobType:a,jobId:n}=t;try{return await this.fetchBucket(e,"GET",{job_type:a,job_id:n},{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,methodKey:"getBucketJob",defaultResponse:null})}}async function di(t){const{bucket:e,Input:a,Output:n,AudioConvertConfig:o}=t,i=await this.fetchBucket(e,"POST",{job_type:"AudioConvert",media_jobs:""},{},{Input:a,AudioConvertConfig:o,Output:n});return i.data||(i.data={}),i}async function hi(t){const{versionId:e}=t,a=R({versionId:e});return await this._fetchObject(t,"GET",{"x-tos-process":"image/aitag",...a},{})}async function mi(t){const{bucket:e,...a}=t,n=B(a);return this.fetchBucket(e,"PUT",{requestPayment:""},{},{...n})}async function fi(t){const{bucket:e}=t;return await this.fetchBucket(e,"GET",{requestPayment:""},{})}const yi=t=>Object.fromEntries(Object.entries(t).filter(([t,e])=>void 0!==e));var gi,xi,ki,bi,Ti;async function vi(t){const{accountId:e,...a}=t;return await this.fetch("POST","/dataset",{},{"x-tos-account-id":e},yi(a),{})}async function wi(t){const{datasetname:e,accountId:a}=t;return await this.fetch("GET","/dataset",{datasetname:e},{"x-tos-account-id":a})}async function Si(t){const{accountId:e,datasetname:a}=t;return await this.fetch("DELETE","/dataset",{datasetname:a},{"x-tos-account-id":e})}async function Ei(t){const{accountId:e,...a}=t;return await this.fetch("GET","/datasets",yi(a),{"x-tos-account-id":e})}async function Ci(t){const{accountId:e,...a}=t;return await this.fetch("POST","/datasetbinding",{},{"x-tos-account-id":e},yi(a))}async function Bi(t){const{accountId:e,...a}=t;return await this.fetch("DELETE","/datasetbinding",{},{"x-tos-account-id":e},yi(a),{})}async function Ii(t){const{accountId:e,...a}=t;return await this.fetch("GET","/datasetbinding",yi(a),{"x-tos-account-id":e})}async function Ri(t){const{accountId:e,...a}=t;return await this.fetch("GET","/datasetbindings",yi(a),{"x-tos-account-id":e})}async function Pi(t){const{accountId:e,...a}=t;return await this.fetch("POST","/datasetquery",{mode:"SimpleQuery"},{"x-tos-account-id":e},yi(a))}async function Ai(t){const{accountId:e,...a}=t;return await this.fetch("POST","/datasetquery",{mode:"SemanticQuery"},{"x-tos-account-id":e},yi(a))}async function Oi(t){const{bucket:e,tag:a,name:n,audioConvertConfig:o}=t,i=await this.fetchBucket(e,"PUT",{process_template:"",tag:a},{},{Tag:a,Name:n,AudioConvertConfig:o});return i.data={},i}async function Di(t){const{bucket:e,tag:a,prefix:n}=t,o={process_template:"",tag:a};return n&&(o.prefix=n),await this.fetchBucket(e,"GET",o,{})}async function Mi(t){const{bucket:e,id:a,tag:n}=t,o={process_template:"",tag:n,id:a};try{return await this.fetchBucket(e,"GET",o,{})}catch(t){return sa(t,{enableCatchEmptyServerError:this.opts.enableOptimizeMethodBehavior,defaultResponse:null,methodKey:"getBucketDataProcessTemplate"})}}async function ji(t){const{bucket:e,id:a}=t,n=await this.fetchBucket(e,"DELETE",{process_template:"",id:a},{},"");return n.data={},n}async function Ni(t){const{bucket:e,name:a,audioConvertConfig:n}=t,o={Tag:"AudioConvert",Name:a,AudioConvertConfig:n},i=await this.fetchBucket(e,"PUT",{process_template:"",tag:"AudioConvert"},{"Content-Type":"application/json"},o);return i.data={ID:i.data},i}async function _i(t){const{bucket:e,id:a}=t,n={process_template:"",tag:"AudioConvert",id:a};return await this.fetchBucket(e,"GET",n,{})}async function Ui(t){const{bucket:e,id:a}=t,n={process_template:"",tag:"AudioConvert"};a&&(n.id=a);const o=await this.fetchBucket(e,"GET",n,{});return o.data={AudioConvertTemplates:o.data||[]},o}async function Li(t){const{bucket:e,id:a}=t,n={process_template:"",id:a},o=await this.fetchBucket(e,"DELETE",n,{},"");return o.data={},o}async function zi(t){const{bucket:e,name:a,transcodeConfig:n}=t,o={Tag:"Transcode",Name:a,TranscodeConfig:n},i=await this.fetchBucket(e,"PUT",{process_template:"",tag:"Transcode"},{},o);return{...i,data:{ID:i.data}}}async function Fi(t){const{bucket:e,id:a}=t,n={process_template:"",tag:"Transcode",id:a};return await this.fetchBucket(e,"GET",n,{})}async function Gi(t){const{bucket:e,id:a}=t,n={process_template:"",id:a},o=await this.fetchBucket(e,"DELETE",n,{},"");return o.data={},o}async function qi(t){const{bucket:e}=t,a=await this.fetchBucket(e,"GET",{process_template:"",tag:"Transcode"},{});return a.data={VideoConvertTemplates:a.data||[]},a}async function Ki(t){const{bucket:e,input:a,transcodeConfig:n,output:o}=t,i={Tag:"Transcode",Input:a,TranscodeConfig:n,Output:o};return await this.fetchBucket(e,"POST",{job_type:"Transcode",media_jobs:""},{},i)}async function Vi(t){const{bucket:e,jobId:a}=t,n={job_type:"Transcode",job_id:a,media_jobs:""};return await this.fetchBucket(e,"GET",n,{})}async function $i(t){const{bucket:e,input:a,audioConvertConfig:n,output:o}=t,i={Tag:"AudioConvert",Input:a,AudioConvertConfig:n,Output:o};return await this.fetchBucket(e,"POST",{job_type:"AudioConvert",media_jobs:""},{},i)}async function Hi(t){const{bucket:e,jobId:a}=t,n={job_type:"AudioConvert",job_id:a};return await this.fetchBucket(e,"GET",n,{})}async function Wi(t){const{accountId:e}=t;return await this.fetch("GET","/templates",{},{"x-tos-account-id":e},{})}async function Ji(t){const{bucket:e,targetRedundancyType:a}=t;return this.fetchBucket(e,"POST",{redundancyTransition:"","x-tos-target-redundancy-type":a},{},{})}async function Qi(t){const{bucket:e,redundancyTransitionTaskId:a}=t;return await this.fetchBucket(e,"GET",{redundancyTransition:"","x-tos-redundancy-transition-taskid":a},{})}async function Xi(t){const{bucket:e,redundancyTransitionTaskId:a}=t;return this.fetchBucket(e,"DELETE",{redundancyTransition:"","x-tos-redundancy-transition-taskid":a},{})}async function Yi(t){const{bucket:e,maxKeys:a,continuationToken:n}=t;return this.fetchBucket(e,"GET",{redundancyTransition:"","max-keys":a,"continuation-token":n},{})}async function Zi(t){const{bucket:e}=t;return this.fetchBucket(e,"GET",{estimatedRemainingTime:""},{})}async function tc(t){const{continuationToken:e,maxKeys:a}=t;return this.fetch("GET","/",{redundancyTransition:"","max-keys":a,"continuation-token":e},{})}async function ec(t){const{bucket:e,rules:a}=t;return this.fetchBucket(e,"PUT",{workflow:""},{},{Rules:a})}async function ac(t){const{bucket:e}=t;return this.fetchBucket(e,"GET",{workflow:""},{})}async function nc(t){const{bucket:e}=t,a=await this.fetchBucket(e,"DELETE",{workflow:""},{});return a.data||(a.data={}),a}async function oc(t){const{Name:e,AccountId:a,VpcId:n,Subnets:o,SecurityGroupId:i}=t;return await this.fetch("PUT","/apap",{name:e},{"x-tos-account-id":a},yi({Name:e,VpcId:n,Subnets:o,SecurityGroupId:i}))}async function ic(t){const{AccountId:e,...a}=t;return await this.fetch("GET","/apap",yi(a),{"x-tos-account-id":e})}async function cc(t){const{AccountId:e}=t;return await this.fetch("GET","/apap/az",{},{"x-tos-account-id":e})}async function sc(t){const{AccountId:e}=t;return await this.fetch("GET","/apap/endpoint",{},{"x-tos-account-id":e})}!function(t){t.BasicInfoTemplate="basic_info_template",t.ImageSemanticTemplate="image_semantic_template"}(gi||(gi={})),function(t){t.INDEXING="Indexing",t.DONE="Done",t.FAILED="Failed"}(xi||(xi={})),function(t){t.NOT="not",t.OR="or",t.AND="and",t.LT="lt",t.LTE="lte",t.GT="gt",t.GTE="gte",t.EQ="eq",t.EXIST="exist",t.PREFIX="prefix",t.MATCH_PHRASE="match-phrase"}(ki||(ki={})),function(t){t.MIN="min",t.MAX="max",t.AVERAGE="average",t.SUM="sum",t.COUNT="count",t.DISTINCT="distinct",t.GROUP="group"}(bi||(bi={})),function(t){t.TEXT="text",t.IMAGE="image"}(Ti||(Ti={}));class rc extends we{constructor(...t){super(...t),this.createBucket=Ae,this.headBucket=De,this.doesBucketExist=Me,this.deleteBucket=Oe,this.listBuckets=Pe,this.getBucketLocation=ya,this.getBucketInfo=Ne,this.putBucketStorageClass=je,this.getBucketAcl=Ue,this.putBucketAcl=_e,this.putBucketHttpsConfig=Le,this.getBucketHttpsConfig=ze,this.getBucketPolicy=ua,this.putBucketPolicy=ra,this.deleteBucketPolicy=pa,this.getBucketVersioning=la,this.putBucketVersioning=da,this.getBucketCORS=ga,this.putBucketCORS=xa,this.deleteBucketCORS=ka,this.putBucketLifecycle=ba,this.getBucketLifecycle=Ta,this.deleteBucketLifecycle=va,this.putBucketEncryption=wa,this.getBucketEncryption=Sa,this.deleteBucketEncryption=Ea,this.putBucketMirrorBack=Ca,this.getBucketMirrorBack=Ba,this.deleteBucketMirrorBack=Ia,this.putBucketReplication=Oa,this.getBucketReplication=Da,this.deleteBucketReplication=Ma,this.putBucketWebsite=ja,this.getBucketWebsite=Na,this.deleteBucketWebsite=_a,this.putBucketNotification=Ua,this.getBucketNotification=La,this.putBucketCustomDomain=za,this.getBucketCustomDomain=Fa,this.deleteBucketCustomDomain=Ga,this.putBucketRealTimeLog=qa,this.getBucketRealTimeLog=Ka,this.deleteBucketRealTimeLog=Va,this.getBucketInventory=Za,this.listBucketInventory=tn,this.putBucketInventory=an,this.deleteBucketInventory=en,this.putBucketTagging=pn,this.getBucketTagging=ln,this.deleteBucketTagging=dn,this.putBucketPayByTraffic=hn,this.getBucketPayByTraffic=mn,this.getBucketImageStyle=xn,this.getBucketImageStyleList=yn,this.getBucketImageStyleListByName=gn,this.getImageStyleBriefInfo=fn,this.deleteBucketImageStyle=bn,this.putBucketImageStyle=kn,this.putBucketImageStyleSeparator=wn,this.putBucketImageProtect=Tn,this.getBucketImageProtect=vn,this.getBucketImageStyleSeparator=Sn,this.putBucketRename=Cn,this.getBucketRename=Bn,this.deleteBucketRename=In,this.putBucketTransferAcceleration=zn,this.getBucketTransferAcceleration=Fn,this.copyObject=ce,this.resumableCopyObject=re,this.deleteObject=Je,this.deleteMultiObjects=Xe,this.getObject=pe,this.getObjectV2=de,this.getObjectToFile=he,this.getObjectAcl=Ye,this.headObject=oe,this.doesObjectExist=We,this.appendObject=aa,this.listObjects=Ee,this.renameObject=Qe,this.fetchObject=Ke,this.putFetchTask=Ve,this.getFetchTask=$e,this.listObjectsType2=Be,this.listObjectVersions=Ce,this.putObject=Fe,this.putObjectFromFile=qe,this.putObjectAcl=Ze,this.setObjectMeta=na,this.createMultipartUpload=$,this.uploadPart=xt,this.uploadPartFromFile=kt,this.completeMultipartUpload=bt,this.abortMultipartUpload=ta,this.uploadPartCopy=ie,this.listMultipartUploads=ea,this.listParts=W,this.downloadFile=fe,this.putObjectTagging=Ra,this.getObjectTagging=Pa,this.deleteObjectTagging=Aa,this.listJobs=on,this.createJob=nn,this.deleteJob=rn,this.describeJob=un,this.updateJobStatus=sn,this.updateJobPriority=cn,this.restoreObject=Rn,this.uploadFile=wt,this.getPreSignedUrl=He,this.calculatePostSignature=oa,this.preSignedPostSignature=oa,this.preSignedPolicyURL=ha,this.getBucketIntelligenttiering=En,this.listStorageLens=Pn,this.deleteStorageLens=An,this.getStorageLens=On,this.putStorageLens=Dn,this.putBucketNotificationType2=Mn,this.getBucketNotificationType2=jn,this.putSymlink=Nn,this.getSymlink=Un,this.putBucketAccessMonitor=Gn,this.getBucketAccessMonitor=qn,this.putQosPolicy=Vn,this.getQosPolicy=Kn,this.deleteQosPolicy=$n,this.createMultiRegionAccessPoint=Hn,this.getMultiRegionAccessPoint=Wn,this.listMultiRegionAccessPoints=Jn,this.getMultiRegionAccessPointRoutes=Qn,this.deleteMultiRegionAccessPoint=Xn,this.submitMultiRegionAccessPointRoutes=Yn,this.bindAcceleratorWithMultiRegionAccessPoint=Zn,this.unbindAcceleratorWithMultiRegionAccessPoint=to,this.listBindAccessPointForMultiRegionAccelerator=eo,this.putMultiRegionAccessPointMirrorBack=vo,this.getMultiRegionAccessPointMirrorBack=wo,this.deleteMultiRegionAccessPointMirrorBack=So,this.putMultiRegionAccessPointPolicy=Xo,this.getMultiRegionAccessPointPolicy=Yo,this.deleteMultiRegionAccessPointPolicy=Zo,this.putAccessPointPolicy=Wo,this.getAccessPointPolicy=Jo,this.deleteAccessPointPolicy=Qo,this.createAccessPoint=ao,this.getAccessPoint=no,this.listAccessPoints=oo,this.deleteAccessPoint=io,this.bindAcceleratorWithAccessPoint=co,this.unbindAcceleratorWithAccessPoint=so,this.listBindAccessPointForAccelerator=ro,this.listAcceleratorAzs=mo,this.putAccelerator=uo,this.getAccelerator=po,this.listAccelerators=lo,this.deleteAccelerator=ho,this.listBindAcceleratorForAccessPoint=To,this.putAcceleratorPrefetchJob=fo,this.getAcceleratorPrefetchJob=yo,this.deleteAcceleratorPrefetchJob=go,this.listAcceleratorPrefetchJobs=xo,this.listAcceleratorPrefetchJobRecords=ko,this.getAcceleratorCapacityQuota=bo,this.putBucketPrivateM3U8=Eo,this.getBucketPrivateM3U8=Co,this.putBucketBlindWatermark=Bo,this.getBucketBlindWatermark=Io,this.putBucketTrash=Ro,this.getBucketTrash=Po,this.putBucketObjectLockConfiguration=Ao,this.getBucketObjectLockConfiguration=Oo,this.putObjectRetention=Do,this.getObjectRetention=Mo,this.putBucketCdnNotification=jo,this.getBucketCdnNotification=No,this.deleteBucketCdnNotification=_o,this.putBucketWorkflow=Uo,this.getBucketWorkflow=Lo,this.deleteBucketWorkflow=zo,this.getBucketWorkflowExecution=Fo,this.listBucketWorkflowExecution=Go,this.putConvertWorkflow=ec,this.getConvertWorkflow=ac,this.deleteConvertWorkflow=nc,this.putBucketAudit=ei,this.getBucketAudit=ti,this.listBucketAuditJob=ai,this.getBucketAuditJob=ni,this.postBucketAuditJob=oi,this.listBucketAuditBizType=ii,this.postBucketIncrementAudit=ci,this.listBucketIncrementAudits=si,this.getBucketIncrementAudit=ri,this.deleteBucketIncrementAudit=ui,this.createFileCompress=qo,this.createFileUncompress=Ko,this.createBucketAudioConvert=di,this.getAudioConvertJob=Hi,this.createAudioConvertJob=$i,this.listBucketJob=pi,this.getBucketJob=li,this.putBucketLogging=$o,this.getBucketLogging=Vo,this.deleteBucketLogging=Ho,this.getObjectAITag=hi,this.putBucketRequestPayment=mi,this.getBucketRequestPayment=fi,this.createDataset=vi,this.deleteDataset=Si,this.listDataset=Ei,this.getDataset=wi,this.createDatasetBinding=Ci,this.deleteDatasetBinding=Bi,this.listDatasetBindings=Ri,this.getDatasetBinding=Ii,this.datasetSimpleQuery=Pi,this.listTemplates=Wi,this.datasetSemanticQuery=Ai,this.putBucketDataProcessTemplate=Oi,this.putAudioConvertTemplate=Ni,this.getBucketDataProcessTemplate=Mi,this.deleteBucketDataProcessTemplate=ji,this.listBucketDataProcessTemplates=Di,this.getAudioConvertTemplate=_i,this.deleteAudioConvertTemplate=Li,this.listAudioConvertTemplates=Ui,this.putVideoConvertTemplate=zi,this.getVideoConvertTemplate=Fi,this.deleteVideoConvertTemplate=Gi,this.listVideoConvertTemplates=qi,this.createVideoConvertJob=Ki,this.getVideoConvertJob=Vi,this.createBucketDataRedundancyTransition=Ji,this.getBucketDataRedundancyTransition=Qi,this.listBucketDataRedundancyTransition=Yi,this.deleteBucketDataRedundancyTransition=Xi,this.listUserDataRedundancyTransition=tc,this.getBucketTransitionEstimatedRemainingTime=Zi,this.putAnyPrivateAccessPoint=oc,this.listAnyPrivateAccessPoints=ic,this.listAnyPrivateAccessPointSupportAz=cc,this.listAnyPrivateAccessPointEndpoints=sc}}async function uc(t){const{vectorBucketName:e}=t,a=await this.fetchVectors("POST","/CreateVectorBucket",{},{},{vectorBucketName:e});return a.data={},a}async function pc(t){const{prefix:e,nextToken:a,maxResults:n,projectName:o}=t,i={};return o&&(i["x-tos-project-name"]=o),this.fetchVectors("POST","/ListVectorBuckets",{},i,{prefix:e,nextToken:a,maxResults:n})}async function lc(t){const{accountID:e}=t,a={vectorBucketName:t.vectorBucketName};return await this.fetchVectors("POST","/GetVectorBucket",{},{},a,{bucket:t.vectorBucketName,accountId:e})}async function dc(t){const{vectorBucketName:e,accountID:a}=t,n={vectorBucketName:t.vectorBucketName},o=await this.fetchVectors("POST","/DeleteVectorBucket",{},{},n,{bucket:e,accountId:a});return o.data={},o}async function hc(t){const e={vectorBucketName:t.vectorBucketName,policy:t.policy},a=await this.fetchVectors("POST","/PutVectorBucketPolicy",{},{},e,{bucket:t.vectorBucketName,accountId:t.accountID});return a.data={},a}async function mc(t){const{vectorBucketName:e,accountId:a}=t,n={vectorBucketName:e};return await this.fetchVectors("POST","/GetVectorBucketPolicy",{},{},n,{accountId:a,bucket:e})}async function fc(t){const e={vectorBucketName:t.vectorBucketName},a=await this.fetchVectors("POST","/DeleteVectorBucketPolicy",{},{},e,{bucket:t.vectorBucketName,accountId:t.accountID});return a.data={},a}async function yc(t){const{vectorBucketName:e,accountID:a}=t,n={dataType:t.dataType,dimension:t.dimension,distanceMetric:t.distanceMetric,indexName:t.indexName,metadataConfiguration:t.metadataConfiguration,vectorBucketName:t.vectorBucketName};return await this.fetchVectors("POST","/CreateIndex",{},{},n,{bucket:e,accountId:a})}async function gc(t){const{vectorBucketName:e,accountID:a}=t,n={indexName:t.indexName,vectorBucketName:t.vectorBucketName},o=await this.fetchVectors("POST","/DeleteIndex",{},{},n,{bucket:e,accountId:a});return o.data={},o}async function xc(t){const{vectorBucketName:e,accountID:a}=t,n={vectorBucketName:t.vectorBucketName,maxResults:t.maxResults,nextToken:t.nextToken,prefix:t.prefix};return await this.fetchVectors("POST","/ListIndexes",{},{},n,{bucket:e,accountId:a})}async function kc(t){const e={indexName:t.indexName,vectorBucketName:t.vectorBucketName};return await this.fetchVectors("POST","/GetIndex",{},{},e,{accountId:t.accountID,bucket:t.vectorBucketName})}async function bc(t){const{vectorBucketName:e,accountID:a}=t,n={indexName:t.indexName,vectorBucketName:t.vectorBucketName,vectors:t.vectors};return await this.fetchVectors("POST","/PutVectors",{},{},n,{bucket:e,accountId:a})}async function Tc(t){const{vectorBucketName:e,accountID:a}=t,n={indexName:t.indexName,maxResults:t.maxResults,nextToken:t.nextToken,returnData:t.returnData,returnMetadata:t.returnMetadata,vectorBucketName:t.vectorBucketName};return await this.fetchVectors("POST","/ListVectors",{},{},n,{bucket:e,accountId:a})}async function vc(t){const{vectorBucketName:e,accountID:a}=t,n={indexName:t.indexName,keys:t.keys,returnData:t.returnData,returnMetadata:t.returnMetadata,vectorBucketName:t.vectorBucketName};return await this.fetchVectors("POST","/GetVectors",{},{},n,{bucket:e,accountId:a})}async function wc(t){const{vectorBucketName:e,accountID:a}=t,n={indexName:t.indexName,keys:t.keys,vectorBucketName:t.vectorBucketName},o=await this.fetchVectors("POST","/DeleteVectors",{},{},n,{bucket:e,accountId:a});return o.data={},o}async function Sc(t){const{vectorBucketName:e,accountID:a}=t,n={vectorBucketName:t.vectorBucketName,indexName:t.indexName,returnDistance:t.returnDistance,returnMetadata:t.returnMetadata,topK:t.topK,queryVector:t.queryVector,filter:t.filter};return await this.fetchVectors("POST","/QueryVectors",{},{},n,{bucket:e,accountId:a})}const Ec=a.CancelToken;class Cc extends rc{}Cc.TosServerError=b,Cc.isCancel=j,Cc.CancelError=v,Cc.TosServerCode=exports.TosServerCode,Cc.TosClientError=T,Cc.CancelToken=Ec,Cc.ACLType=exports.ACLType,Cc.StorageClassType=exports.StorageClassType,Cc.MetadataDirectiveType=exports.MetadataDirectiveType,Cc.AzRedundancyType=exports.AzRedundancyType,Cc.PermissionType=exports.PermissionType,Cc.GranteeType=exports.GranteeType,Cc.CannedType=exports.CannedType,Cc.HttpMethodType=exports.HttpMethodType,Cc.LifecycleStatusType=exports.LifecycleStatusType,Cc.StatusType=exports.StatusType,Cc.RedirectType=exports.RedirectType,Cc.StorageClassInheritDirectiveType=exports.StorageClassInheritDirectiveType,Cc.TierType=exports.TierType,Cc.FileUncompressPrefixReplaced=exports.FileUncompressPrefixReplaced,Cc.FileCompressFlatten=exports.FileCompressFlatten,Cc.VersioningStatusType=exports.VersioningStatusType,Cc.createDefaultRateLimiter=Z,Cc.DataTransferType=exports.DataTransferType,Cc.UploadEventType=exports.UploadEventType,Cc.DownloadEventType=exports.DownloadEventType,Cc.ResumableCopyEventType=exports.ResumableCopyEventType,Cc.ReplicationStatusType=exports.ReplicationStatusType,Cc.AccessPointStatusType=exports.AccessPointStatusType,Cc.AccessPointStatus=exports.AccessPointStatus,Cc.AcceleratorPrefetchJobStatus=exports.AcceleratorPrefetchJobStatus,Cc.TransferAccelerationStatusType=exports.TransferAccelerationStatusType,Cc.MRAPMirrorBackRedirectPolicyType=exports.MRAPMirrorBackRedirectPolicyType,Cc.WorkflowExecutionStateType=exports.WorkflowExecutionStateType,Cc.ShareLinkClient=Re,Cc.AuditJobStateType=exports.AuditJobStateType,Cc.AuditScanType=exports.AuditScanType,Cc.AuditType=exports.AuditType,Cc.CallbackTriggerModeType=exports.CallbackTriggerModeType,Cc.FreezeModeType=exports.FreezeModeType,Cc.TemplateTagType=exports.TemplateTagType,Cc.AudioContainerFormatType=exports.AudioContainerFormatType,Cc.SampleFormatType=exports.SampleFormatType,exports.CancelError=v,exports.CancelToken=Ec,exports.ShareLinkClient=Re,exports.TOS=Cc,exports.TosClient=Cc,exports.TosClientError=T,exports.TosServerError=b,exports.TosVectorsClient=class extends we{constructor(t){super(t),this.serviceName="tosvectors",this.createVectorBucket=uc,this.listVectorBuckets=pc,this.getVectorBucket=lc,this.deleteVectorBucket=dc,this.putVectorBucketPolicy=hc,this.getVectorBucketPolicy=mc,this.deleteVectorBucketPolicy=fc,this.createIndex=yc,this.deleteIndex=gc,this.getIndex=kc,this.listIndexes=xc,this.putVectors=bc,this.listVectors=Tc,this.getVectors=vc,this.deleteVectors=wc,this.queryVectors=Sc}async fetchVectors(t,e,a,n,o,i){return void 0!==(null==i?void 0:i.bucket)&&(t=>{if(t){if(t.length<3||t.length>32)throw new T("invalid vector bucket name, the length must be [3, 32]");if(!/^([a-z]|-|\d)+$/.test(t))throw new T("invalid vector bucket name, the character set is illegal");if(/^-/.test(t)||/-$/.test(t))throw new T("invalid vector bucket name, the vector bucket name can be neither starting with '-' nor ending with '-'")}})(null==i?void 0:i.bucket),void 0!==(null==i?void 0:i.accountId)&&(t=>{if(""===t)throw new T("invalid account id, the account id must be non-empty");if(!/^\d+$/.test(t))throw new T("invalid account id, the account id must be a number")})(null==i?void 0:i.accountId),this.fetch(t,e,a,n,o,{serviceName:this.serviceName,subdomainBucket:null!=i&&i.accountId?`${null==i?void 0:i.bucket}-${null==i?void 0:i.accountId}`:void 0})}},exports.createDefaultRateLimiter=Z,exports.default=Cc,exports.isCancel=j;
//# sourceMappingURL=tos.cjs.production.min.js.map
